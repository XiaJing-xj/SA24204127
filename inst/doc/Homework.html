<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xia Jing" />

<meta name="date" content="2024-12-07" />

<title>Homework by SA24204127</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework by SA24204127</h1>
<h4 class="author">Xia Jing</h4>
<h4 class="date">2024-12-07</h4>



<div id="homework---0" class="section level1">
<h1>Homework - 0</h1>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>随机变量 <span class="math inline">\(X\sim B(1,0.5),Y_1\sim
N(3,1),Y_2\sim N(6,1)\)</span>，记 <span class="math inline">\(Z=I(X=1)Y_1+I(X=0)Y_2\)</span>，求 <span class="math inline">\(Z\)</span> 的密度函数，并使用程序从总体 <span class="math inline">\(Z\)</span> 中抽取样本容量为 <span class="math inline">\(5000\)</span>
的样本，绘制其直方图并与理论密度函数比较。</p>
<p>解：易知 <span class="math inline">\(f_{Y_1}(y)=\frac1{\sqrt{2\pi}}e^{-\frac{(y-3)^2}2},f_{Y_2}(y)=\frac1{\sqrt{2\pi}}e^{-\frac{(y-6)^2}2}\)</span>
又有</p>
<p><span class="math display">\[
F_Z(z)=P(Z\le z)=P\{I(X=1)Y_1+I(X=0)Y_2\le z\}=\frac12[P(Y_1\le
z)+P(Y_2\le z)]
\]</span></p>
<p><span class="math display">\[
\therefore
f_Z(z)=\frac12[f_{Y_1}(z)+f_{Y_2}(z)]=\frac1{\sqrt{8\pi}}(e^{-\frac{(z-3)^2}2}+e^{-\frac{(z-6)^2}2})
\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 抽样</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>flag <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>sample_Z <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> flag){</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="cf">if</span> (i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>        sample_Z <span class="ot">&lt;-</span> <span class="fu">c</span>(sample_Z,<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>        sample_Z <span class="ot">&lt;-</span> <span class="fu">c</span>(sample_Z,<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">1</span>))</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    }</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>pdf_Z <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">dnorm</span>(x,<span class="dv">3</span>,<span class="dv">1</span>)<span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="dv">6</span>,<span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>step.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>step.x,<span class="at">y=</span><span class="fu">pdf_Z</span>(step.x))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>sample_Z),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>     <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">&#39;样本直方图&#39;</span>,),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                    <span class="at">binwidth =</span> <span class="fl">0.25</span>, </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                    <span class="at">alpha=</span><span class="fl">0.5</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                    <span class="at">boundary=</span><span class="dv">1</span>  <span class="co"># 该参数能够调整 bin 矩形柱 的位置</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                   )<span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">col=</span><span class="st">&#39;实际密度函数&#39;</span>))<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>), <span class="at">name=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>容易看出样本直方图与实际密度函数非常契合。</p>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>随机变量 <span class="math inline">\(X\)</span> 及其分布函数<span class="math inline">\(F(x)\)</span>,其中<span class="math inline">\(F
(x)\)</span>是一个连续函数</p>
<ol style="list-style-type: decimal">
<li>证明 <span class="math inline">\(F(X) ∼ U (0, 1)\)</span></li>
<li>令<span class="math inline">\(F
(x)\)</span>为标准正态分布函数，生成1000个随机数<span class="math inline">\(x_1, ..., x_{1000}\)</span>，画其直方图。</li>
</ol>
<p>解：(1) 设 <span class="math inline">\(Y=F(X)\)</span>
为一随机变量，则 <span class="math display">\[F_Y(y)=P(Y\le y)=P(F(X)\le
y)=P(X \le F^{-1}(y))=F(F^{-1}(y))=y\quad y\in [0,1]\\
\Downarrow \\
Y=F(X)\sim U(0,1)
\]</span> (2)其实现代码如下所示：</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># 导入绘图包</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)  <span class="co"># 设置随机种子</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)  <span class="co"># 从标准正态分布抽取 10000 个样本</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x)  <span class="co"># y = F(x)</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>y),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>     <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                    <span class="at">alpha=</span><span class="fl">0.5</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                    <span class="at">color=</span><span class="st">&#39;black&#39;</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                    <span class="at">boundary=</span><span class="dv">0</span>  <span class="co"># 该参数能够调整 bin 矩形柱 的位置</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>                   )</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>Double-Exponential分布的定义如下： <span class="math display">\[f
(x|\alpha) = \frac\alpha2\exp{(−\alpha|x|)}, x ∈ (−\infty,
\infty)\]</span> 其逆变换的公式为： <span class="math display">\[
x=\begin{cases}\log{(2U)}/\alpha&amp;,U&lt;
0.5\\-\log{(2-2U)}/\alpha&amp;,U&gt;0.5 \end{cases}
\]</span> 其中 <span class="math inline">\(U\sim U(0,1)\)</span>
，完成以下问题</p>
<ol style="list-style-type: decimal">
<li>如何使用接受拒绝法生成<span class="math inline">\(X ∼ f
(x)\)</span>的随机变量?</li>
<li>若<span class="math inline">\(\alpha = 1\)</span>,
选择一个M，使用Double-Exponential分布作为proposal分布,
使用接受拒绝法，生成1000个标准正态随机数<span class="math inline">\(x_1,
..., x_{1000}\)</span>,其中分布函数为 <span class="math display">\[f(x)
= \frac1{\sqrt{2\pi}}\exp{(-\frac{x^2}2)}\]</span>
画出直方图，与密度函数进行对比。</li>
</ol>
<p>解：(1) 设 <span class="math inline">\(Y\sim g(y)\quad
y\in(-\infty,+\infty)\)</span> 为一易生成的随机变量，<span class="math inline">\(M\)</span> 为一常数，<span class="math inline">\(\forall x\in R,s.t Mg(x)\ge f_X(x)\)</span>，
<span class="math inline">\(U|Y=y \sim U(0,Mg(y))\)</span> 则有 <span class="math display">\[
f_{UY}(u,y)=g(y)f_{U|Y}(u)=g(y)*\frac{1}{Mg(y)}=\frac1M
\]</span> 记 <span class="math inline">\(T=Y|U\le f_X(y)\)</span>, 则
<span class="math display">\[
\begin{aligned}
P(T\le t)&amp;=P(Y\le t|U\le f_X(y))\\
&amp;=\frac{P(Y\le t,U\le f_X(y))}{P(U\le f_X(y))}\\
&amp;=\frac{\int_{-\infty}^t\int_0^{f_X(y)}\frac1Mdudy}{\int_{-\infty}^{+\infty}\int_0^{f_X(y)}\frac1Mdudy}\\
&amp;=\int_{-\infty}^tf_X(y)dy\\
&amp;=F_X(t)
\end{aligned}
\]</span> 所以 T 即为所求随机变量。</p>
<p>(2)其实现代码如下所示：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 计数 所求随机变量</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>all.num <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 计数 全部</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>func.ni <span class="ot">&lt;-</span> <span class="cf">function</span>(u,alpha){</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="co"># Double-Exponential分布的逆变换公式</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="cf">if</span> (u <span class="sc">&lt;</span> <span class="fl">0.5</span>){</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>        <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u)<span class="sc">/</span>alpha</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>        <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u)<span class="sc">/</span>alpha</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    }</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>}</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>gx <span class="ot">&lt;-</span> <span class="cf">function</span>(x,alpha){alpha<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">*</span><span class="fu">abs</span>(x))}  <span class="co"># Double-Exponential分布的密度函数</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="cf">while</span>(num<span class="sc">&lt;</span>n){</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>    all.num <span class="ot">&lt;-</span> all.num<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    </span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">func.ni</span>(<span class="fu">runif</span>(<span class="dv">1</span>),alpha)</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>    u <span class="ot">&lt;-</span> M<span class="sc">*</span><span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fu">gx</span>(y,alpha)</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    <span class="cf">if</span> (u<span class="sc">&lt;=</span><span class="fu">dnorm</span>(y)){</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>        num <span class="ot">&lt;-</span> num<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    }</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>}</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>step.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.1</span>)</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>step.x,<span class="at">y=</span><span class="fu">dnorm</span>(step.x))</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>x),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>     <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">&#39;样本直方图&#39;</span>,),</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>                    <span class="at">binwidth =</span> <span class="fl">0.25</span>, </span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>                    <span class="at">alpha=</span><span class="fl">0.5</span>,</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>                    <span class="at">boundary=</span><span class="dv">1</span>  <span class="co"># 该参数能够调整 bin 矩形柱 的位置</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>                   )<span class="sc">+</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">col=</span><span class="st">&#39;实际密度函数&#39;</span>))<span class="sc">+</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>), <span class="at">name=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>容易看出样本直方图与实际密度函数保持一致。</p>
</div>
</div>
<div id="homework---1" class="section level1">
<h1>Homework - 1</h1>
<div id="exercise-1-3.4" class="section level2">
<h2>Exercise-1 3.4</h2>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[
f(x)=\frac x{\sigma^2}e^{-x^2/(2\sigma^2)},\ x\ge0,\sigma&gt;0.
\]</span> Develop an algorithm to generate random samples from a
Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several
choices of σ &gt; 0 and check that the mode of the generated samples is
close to the theoretical mode σ(check the histogram).</p>
<p>解：使用逆变换法生成该随机变量。 易知： <span class="math display">\[
\begin{aligned}
F(x)&amp;=\int_0^xf(t)dt=\int_0^x\frac
t{\sigma^2}e^{-t^2/(2\sigma^2)}dt\\
&amp;=\int_0^xe^{-\frac{t^2}{2\sigma^2}}d\frac{t^2}{2\sigma^2}\\
&amp;=1-e^{-\frac{x^2}{2\sigma^2}},\ x\ge0,\sigma&gt;0
\end{aligned}
.
\]</span> 故有： <span class="math inline">\(F^{-1}(u)=\sqrt{-2\sigma^2\ln(1-u)},0&lt;u&lt;1\)</span>，若
<span class="math inline">\(U\sim U(0,1)\)</span>，则 <span class="math inline">\(F^{-1}(U)\sim F(x)\)</span>。</p>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>func_inverse <span class="ot">&lt;-</span> <span class="cf">function</span>(u,sigma){</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    <span class="co"># 分布函数的逆函数</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>}</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>func_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x,sigma){</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="co"># 密度函数</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>func_paint <span class="ot">&lt;-</span> <span class="cf">function</span>(sample.x,sigma){</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    <span class="co"># 绘图</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    x.min <span class="ot">&lt;-</span> <span class="fu">min</span>(sample.x)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>    x.max <span class="ot">&lt;-</span> <span class="fu">max</span>(sample.x)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    step.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(x.min,x.max,<span class="fl">0.1</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>step.x,<span class="at">y=</span><span class="fu">func_density</span>(step.x,sigma))</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>sample.x),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">&#39;样本直方图&#39;</span>,),</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>                        <span class="at">binwidth =</span> <span class="fl">0.25</span>, </span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>                        <span class="at">alpha=</span><span class="fl">0.5</span>,</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>                        <span class="at">boundary=</span><span class="dv">1</span>  <span class="co"># 该参数能够调整 bin 矩形柱 的位置</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>         <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">col=</span><span class="st">&#39;实际密度函数&#39;</span>))<span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>         <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>), <span class="at">name=</span><span class="fu">paste0</span>(<span class="st">&#39;sigma=&#39;</span>,sigma))</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(num)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># example 1</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>sample<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,sigma)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">func_paint</span>(sample<span class="fl">.1</span>,sigma)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># example 2</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>sample<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,sigma)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">func_paint</span>(sample<span class="fl">.2</span>,sigma)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># example 3</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>sample<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,sigma)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">func_paint</span>(sample<span class="fl">.3</span>,sigma)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQkGaQtpCQ27aQ2/+ioqKrbk2rbm6rbo6ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+v/AAD/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///9wEzz2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKXElEQVR4nO3dD1+cNhgH8GitrbWddlvb6bquW3XaW//c6bTK+39hIySBhCQ8CXABLr9f/XgI593l24fAcQZYgXSGTf0C5h4AEQEQEQARARARABEZCvS9TPVNpfBMR91rlKaNEwARARARABEBEBEAEQEQEQARARARABHpAPrx9sWrb3L67pfP9Qx9fs5Ajx/Piq8/iembFy8/qxn6fCcQY3kA/fjtsyicorg+/lROyBna/CJroLtfvxU/3l3IH0oROaOZ/7SM6yF36giBvzE3r1pAcoYxHxXUVUE8GQMZfc0d+iArjx/fNFsrLiJnGPNzBpL7O6JYYvaDsgEKitVCxgCkB0BEAETEAySQAAQgMgAiAiAiTiDVUQMIQGQARARARABEBEBEAEQEQEQARARARABEBEBEAEQEQNEPKDP2406VrVTQeo0KUnEBrcsASMYJxL8AJOIBYmt+1BVATqA1A1ATL9AaQFV8QAxAIjaQ8AGQDICIeIH4lh5AACIDICJWC5UPgEQARMQPVO5MAwhAZABEpN3CxgdAVQBEpAOIrQEEIDI5AzWDVsTU1xc8Z9XtS99wqIyAmsG72jBePtzw+ky7V8ZAzcA5berdRfH414V2r4yBmqGXzRSvo3J94yta4RrUW5poQMV6iy88VUIG9dZT1be7n/UqMkug+jCjzvd1bhV0U480rPuhNhDLB8jRB12/UQsBpA/qVVNixeJl9Pi3ezOfFZA2qFeN5hWj5cv9oON6Q9YFxHYcKCgAItIJVKy7HQAEoBaQ6VMCsU6H7IEYgABEBUBEuoH0DT2AAOQKgIjoLWQMQFYARARARAwgy0cXAhCAXJkC6PbZh7AXtxGv4XRIA5cIFJfLJ1+G/PqIQI4+egZAm73AcvNkUUC3h9UKw1ex+xO29/751e2z9+W8I77gVC4/EjeMVTIP5wfDGrgkoKrvuT08LW/vT45Ko/2r28NyBVox/m3/6v6kRCpv9d8ZWkBbB2qERgB6LtpeAm04w4oDVYVzWs3870th9eCXAwtozEG9HqDxnqC4ZIy3tzRY8Z73lq9iH1Rl8W8btWapVEU1KEuqoII3mO1f+YDuT0qc8lbrgzbmCtcjCwOqakKtYpt9E2jD1cxOZzVsG1+YQNX/QGR0IJfPmECVCq8QrZM2gHgBHRptGNwFtSqoXMkjyVMCqS5GbeZ/bwHxl7/3h97rPJwfRXpYaa9i5ROzmAelgdS5b8ffUdwMXn8CYvdBnCi8a5sIiK9Ng/cBg9IGWlVb0vD3LyRQ/cnGuBVUvk6WwscEejiXb33Dt45TASWLuRWL32vIDCiyfAoAkckIaFU3Kabzywio3zu7lEDf3enX8NCM+V5st4HK8uG7iDzj9kHqzcbSgXpGa6HHB0AZAYnVLGpvMS+gywN+nHfVczO/+0BlAfF3yH13FLMA4kfqlgzk61KZ4wf1+pqZrt/W5z2cH/HjLFGHKQOApNC2gbQnLOpvzJxf6NM6AJP/uoH4R5IHzbGg9qBeNZrXc4U6325QMiCtTUz7sSkNpr7MeWIqpILM2IN6xSAx35V6pwaqBfQJw6wwKojVYLLYZOEFA1kD6uQ4TN9VMjuAus9bGgG0tmLeuXaoG80KTaJdQY1SwZiD1QKSn7iJTtoakilH83qu1Ov+VEwCef8XokJVkL7i1KuNxiANZJ009xALWePrAzKPgluDeuVoXs+VejuBJlrFms5FrlR6c1mbzt1N+w93uIaF837Ic6XeyYG0J2w1WOtYnGueZklVkA7kOrEAB/L0QX6fdBXU7OIY/YvWTNaUlb6K6WYdQOYuojWoV47m9VyptwNIbMZSADFZLs0K1dqutztqTcuznTdXMdEeyWQN6pWjed37QTMAYu1tvLmr06xJWg9e30EsJSqoR+YDpO8cM31O0zXJjZisML3PMvui3QTaUkygFWOncX9SkxfQ5ZN/xRGP8GQFVB3uOO15uANA7qQE8jz6oPaTMR5+xVcxfswsPEFAldAIQH+6khJIjP6I+qu1QCC2I0DxqRvV5QOgHIDU+wzW86PnnQfiqQaCxP2NR1ZAg/6AigDqOH/7aECtt+R605g9qb28rgamAeJCSYD0N+S2hDFfP0AbCKRWsV77QbMAUhBWdagbbX5zeDocSOwHRf2ZmWpU525QEiCpYRaUwdKaq44BxQDFZz5A+kHUaqLuW6zDZ/VE29T1pNEkZmYExJqVpqiPSYsFegWpaVVxLLyTXjyQuQ1jZukYFaQ2eK2Dr64n7QmjMh8g48NC7UC8sw9iutccgPinq9uuoML40Es/SK811fSL3cwPSADQ8OcI7qS1DX5hVpABVBSz6aQTVZDRoPYeY2svW3txXQ0cC4jwmRJIg6j7JOcd3U/aR0XLnIC2EgARWRSQOwNbQCQVUMc1JIKBJgmAiKQDYsyDAiAAAcgfABEJBjLOLQ0gAKnIRlHvVQEEIE8ARARARGSjaB/zSj8AApAMgIgAiEgMkOcyLYsFsgb13r2urh/qulJvjkDWoF4+io6POnRdqTcEyHeJhKUCWQPqbrjW9ZnzSr05AjmHZDZjewtjUG8Y0NZbs4X4gRxX6q3GHjqv1IsKEpcyfquuRNu+EG2OQPag3rvXdffcAgp4K7Z7QNagXunjulJvGJDnCgBLBbIG9fL9H949O67UGwrEdgooKAAiEgnkOrl0DkBhPgAKEQIQgIwAiAiAiACISByQ89zJGQAF7gYBCEB2AEQkEkgJAQhAMgAiAiAisUCOM98CCEAA8qdqToQPgAKEWmc62W2gKnFAxbaHeI0aVBCR9EDWyYQAZAMxABFCAAKQDG9OzH4igMKEAAQgmX5AxvhMALlKCEAAEukH5P2rewA1QHURAcgtlBFQDx99QwYgXwkBiCghABFCAAqrIQB1CDEA0TW0+0B9fWQ/tFgga1CveSMyDIjxK6UuFcga1GveyAwEEkTLBLIG1Jk38l6DgYSR3KJV5+tfCpA1JNO8KZpBvUOBaqQKamYfu0YM6jVv5L08OzL2dNS9kjQ9LEMqiCdjoPA+KFMga1CveSOTMZB9pV7fflCuQEEBEBEAEQEQEQARAVBAnkYv6PMrEwVARABEBEBEZnZwYX4BEBEAEQEQEQARGQxkHPzQUh1TcyyUJ4S1l9yIM8T6Hm+qDAUyPwRqcsNb61goTwhrL+Gg1odKM8hQIPMAbJ3r40/8QJu9UJ4Q1v1r1gHdGWQokHkIX1/Az0zpXmgd+VfhJ2v0Pd5UGQpkfgikhQO5F/KD2q4ld6+PL/yPN1XSV1B1Qlj3r3lLa8JsqQ8SQK6F4oSnvq7L0zlNmOFbsTfurQ5vpWOhPCGsvUSuW97Hmyqp94PUCWGdS44vdm8/aOcDICIAIgIgIgAiAiAiACICICIAIpIIaLX3obg/OUrzZKMmVQVdHvCvBSYV0O2z98+vEj3XqEnWB63YaaqnGjXJgC7ZItewZECb/X9OFllCiYDuS53N/hI7oURAl0++FA/nS1zJsKNIBEBEAEQEQEQARARARABEBEBEAEQEQET+B90hnryr+hxVAAAAAElFTkSuQmCC" /><!-- --></p>
<p>从上述图片中不难看出，样本直方图与理论密度曲线十分契合。</p>
</div>
<div id="exercise-2-3.11" class="section level2">
<h2>Exercise-2 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have N(0, 1) and N(3, 1) distributions
with mixing probabilities <span class="math inline">\(p_1\)</span> and
<span class="math inline">\(p_2 = 1 − p_1\)</span>. Graph the histogram
of the sample with density superimposed, for <span class="math inline">\(p_1 = 0.75\)</span>. Repeat with different values
for <span class="math inline">\(p_1\)</span> and observe whether the
empirical distribution of the mixture appears to be bimodal. Make a
conjecture about the values of <span class="math inline">\(p_1\)</span>
that produce bimodal mixtures.</p>
<p>解：记 <span class="math inline">\(\phi_1,\phi_2\)</span> 分别为N(0,
1)和N(3, 1)的密度函数；则混合分布的密度函数为 <span class="math inline">\(f=p_1\phi_1+(1-p_1)\phi_2\)</span>。</p>
<p>具体实现代码如下：</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>func_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(p1){</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="co"># 根据概率 p1 抽样</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="co"># 返回样本及相应密度函数</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    flag <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(num,<span class="dv">1</span>,p1)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    sample.x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> flag){</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>        <span class="cf">if</span> (i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>            sample.x <span class="ot">&lt;-</span> <span class="fu">c</span>(sample.x,<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>        }<span class="cf">else</span>{</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>            sample.x <span class="ot">&lt;-</span> <span class="fu">c</span>(sample.x,<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>        }</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    }</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>    pdf_x <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>        p1<span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>    }</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sample=</span>sample.x,<span class="at">func=</span>pdf_x))</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>}</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>func_paint2 <span class="ot">&lt;-</span> <span class="cf">function</span>(sample.x,func){</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>    <span class="co"># 绘图</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>    x.min <span class="ot">&lt;-</span> <span class="fu">min</span>(sample.x)</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>    x.max <span class="ot">&lt;-</span> <span class="fu">max</span>(sample.x)</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>    step.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(x.min,x.max,<span class="fl">0.1</span>)</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>step.x,<span class="at">y=</span><span class="fu">func</span>(step.x))</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>sample.x),<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">after_stat</span>(density)))<span class="sc">+</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">&#39;样本直方图&#39;</span>,),</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>                        <span class="at">binwidth =</span> <span class="fl">0.25</span>, </span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>                        <span class="at">alpha=</span><span class="fl">0.5</span>,</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>                        <span class="at">boundary=</span><span class="dv">1</span>  <span class="co"># 该参数能够调整 bin 矩形柱 的位置</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>         <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">col=</span><span class="st">&#39;实际密度函数&#39;</span>))<span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>         <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>), <span class="at">name=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">func_sample</span>(p1)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>sample.x <span class="ot">&lt;-</span> out<span class="sc">$</span>sample</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">func_paint2</span>(sample.x,out<span class="sc">$</span>func)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">func_sample</span>(p1)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>sample.x <span class="ot">&lt;-</span> out<span class="sc">$</span>sample</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">func_paint2</span>(sample.x,out<span class="sc">$</span>func)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">func_sample</span>(p1)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>sample.x <span class="ot">&lt;-</span> out<span class="sc">$</span>sample</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">func_paint2</span>(sample.x,out<span class="sc">$</span>func)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">func_sample</span>(p1)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>sample.x <span class="ot">&lt;-</span> out<span class="sc">$</span>sample</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">func_paint2</span>(sample.x,out<span class="sc">$</span>func)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从上图中不难看出，该混合分布具有双峰的特点。当 <span class="math inline">\(p_1&lt;0.5\)</span> 时，右峰更高；当 <span class="math inline">\(p_1&gt;0.5\)</span> 时，左峰更高；当 <span class="math inline">\(p_1=0.5\)</span> 时，双峰近似对称。</p>
</div>
<div id="exercise-3-3.20" class="section level2">
<h2>Exercise-3 3.20</h2>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t ≥ 0\}\)</span> that can be represented
as the random sum <span class="math inline">\(X(t) =
\sum_{i=1}^{N(t)}Y_i, t ≥ 0,\)</span> where <span class="math inline">\(\{N(t), t ≥ 0\}\)</span> is a Poisson process and
<span class="math inline">\(Y_1, Y_2,...\)</span> are iid and
independent of <span class="math inline">\(\{N(t), t ≥ 0\}\)</span>.
Write a program to simulate a compound Poisson(<span class="math inline">\(λ\)</span>)–Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values. Hint: Show that <span class="math inline">\(E[X(t)] =
λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) =
λtE[Y^2_1]\)</span>.</p>
<p>解：给定参数 <span class="math inline">\(\lambda,\alpha,\beta\)</span> 及时间长度 <span class="math inline">\(T\ge0\)</span>，故有 <span class="math inline">\(\{N(t),t\ge0\}\)</span> 服从参数为 <span class="math inline">\(\lambda\)</span> 的泊松过程，<span class="math inline">\(Y_1,Y_2,\cdots \sim
\Gamma(\alpha,\beta)\)</span>。</p>
<p>可通过以下步骤生成随机过程 <span class="math inline">\(\{X(t),0\le
t\le T\}\)</span></p>
<ul>
<li>根据 <span class="math inline">\(N(1)\sim
Poisson(\lambda),N(2)-N(1)\sim Poisson(\lambda),\cdots,N(T)-N(T-1)\sim
Poisson(\lambda)\)</span> 生成 <span class="math inline">\(\{N(t),0\le
t\le T\}\)</span>；</li>
<li>生成 <span class="math inline">\(N(T)\)</span> 个服从 <span class="math inline">\(\Gamma(\alpha,\beta)\)</span> 的随机变量 <span class="math inline">\(Y_1,\cdots,Y_{N(T)}\)</span>；</li>
<li>根据 <span class="math inline">\(X(t) = \sum_{i=1}^{N(t)}Y_i, t =
0,1,\cdots,T\)</span> 生成随机过程 <span class="math inline">\(\{X(t),0\le t\le T\}\)</span>。</li>
</ul>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co"># generate</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>N_part <span class="ot">&lt;-</span> <span class="fu">rpois</span>(T,lambda)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>N.T <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(N_part)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N.T[T],alpha,beta)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>X.t <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>T){</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>    X.t <span class="ot">&lt;-</span> <span class="fu">c</span>(X.t,<span class="fu">sum</span>(Y[<span class="dv">1</span><span class="sc">:</span>N.T[i]]))</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="fu">plot</span>(X.t,<span class="at">xlab =</span> <span class="st">&#39;T&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>估计 <span class="math inline">\(X(10)\)</span>
的均值和期望：在给定参数条件下，生成样本量为5000，服从 <span class="math inline">\(X(10)=\sum_{i=1}^{N(10)}Y_i\)</span> 的样本，其中
<span class="math inline">\(N(10)\sim
Poisson(10\lambda)\)</span>，使用矩估计方法，用样本期望估计总体期望，样本方差估计总体方差。其实现代码如下所示：</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>FuncForExercise3 <span class="ot">&lt;-</span> <span class="cf">function</span>(theta){</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>    <span class="co"># theta &lt;- c(lambda,alpha,beta)</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    <span class="co"># 生成样本并估计 X_10 的均值和期望，同时输出理论结果</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> theta[<span class="dv">1</span>]</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> theta[<span class="dv">2</span>]</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> theta[<span class="dv">3</span>]</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>    N_10 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(num,t<span class="sc">*</span>lambda)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>    X_10 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num){</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>        Y_list <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_10[i],alpha,beta)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>        X_10 <span class="ot">&lt;-</span> <span class="fu">c</span>(X_10,<span class="fu">sum</span>(Y_list))</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>    }</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>    <span class="co"># 估计值</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>    estimate.mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_10)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>    estimate.var <span class="ot">&lt;-</span> <span class="fu">var</span>(X_10)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>    <span class="co"># 理论值</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>    X_10.mean <span class="ot">&lt;-</span> lambda<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">/</span>beta</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>    X_10.var <span class="ot">&lt;-</span> lambda<span class="sc">*</span>t<span class="sc">*</span>(alpha<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>    out_li <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mean.est=</span>estimate.mean,<span class="at">var.est=</span>estimate.var,</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>                   <span class="at">mean.real=</span>X_10.mean,<span class="at">var.real=</span>X_10.var)</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>    <span class="fu">return</span>(out_li)</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># 参数1</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">FuncForExercise3</span>(theta)</span></code></pre></div>
<pre><code>## $mean.est
## [1] 40.07407
## 
## $var.est
## [1] 121.8296
## 
## $mean.real
## [1] 40
## 
## $var.real
## [1] 120</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># 参数2</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">FuncForExercise3</span>(theta)</span></code></pre></div>
<pre><code>## $mean.est
## [1] 59.73565
## 
## $var.est
## [1] 119.8256
## 
## $mean.real
## [1] 60
## 
## $var.real
## [1] 120</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># 参数3</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">5</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">FuncForExercise3</span>(theta)</span></code></pre></div>
<pre><code>## $mean.est
## [1] 111.8885
## 
## $var.est
## [1] 198.2576
## 
## $mean.real
## [1] 112
## 
## $var.real
## [1] 201.6</code></pre>
<p>从上述结果不难看出，<span class="math inline">\(X(10)\)</span>
均值和方差的矩估计与理论值相差不大。</p>
</div>
</div>
<div id="homework---2" class="section level1">
<h1>Homework - 2</h1>
<div id="exercise-1---5.4" class="section level2">
<h2>Exercise 1 - 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf,and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x =
0.1, 0.2,..., 0.9\)</span>. Compare the estimates with the values
returned by the <code>pbeta</code> function in R.</p>
<p>解：易知 Beta(3,3) 的密度函数为 <span class="math inline">\(f(x)=30x^2(1-x)^2,\ x\in[0,1]\)</span>，则 <span class="math display">\[
F(x)=\int_0^xf(t)dt=\int_0^xf(t)\times x\times\frac1xdt=E[f(T)x],\ T\sim
U(0,x)
\]</span> 故 <span class="math display">\[
\hat F(x) = \frac{30x}{n}\sum_{i=1}^nt_i^2(1-t_i)^2,\
t_i\overset{i.i.d}{\sim} U(0,x)
\]</span> 其实现代码如下：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>x_li <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>hat.Fx <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_li[index]</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>    t_li <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,x)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>    hat.Fx[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(t_li<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t_li)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">30</span><span class="sc">*</span>x</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>}</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>Fx <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x_li,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Fx=</span>Fx,<span class="at">hat.Fx=</span>hat.Fx)</span></code></pre></div>
<pre><code>##        Fx      hat.Fx
## 1 0.00856 0.008538929
## 2 0.05792 0.057531250
## 3 0.16308 0.160226067
## 4 0.31744 0.316922849
## 5 0.50000 0.500982840
## 6 0.68256 0.686201245
## 7 0.83692 0.836369386
## 8 0.94208 0.941718540
## 9 0.99144 0.987008781</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">plot</span>(Fx,hat.Fx)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>不难看出，近似值与理论值相差不大。</p>
</div>
<div id="exercise-2---5.9" class="section level2">
<h2>Exercise 2 - 5.9</h2>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[
f(x) = \frac x{σ^2} e^{−x^2/(2σ^2)}, x ≥ 0,σ&gt; 0.
\]</span> Implement a function to generate samples from a Rayleigh(σ)
distribution, using antithetic variables. What is the percent reduction
in variance of <span class="math inline">\(\frac{X+X^{&#39;}}2\)</span>
compared with <span class="math inline">\(\frac {X_1+X_2}2\)</span> for
independent <span class="math inline">\(X_1, X_2\)</span>?</p>
<p>解：易知 <span class="math inline">\(F(x)=\int_0^xf(t)dt=1-e^{-\frac{x^2}{2\sigma^2}}\)</span>，故有
<span class="math inline">\(F^{-1}(U)=\sqrt{-2\sigma^2\ln(1-U)}\sim
f(x),\ U\sim U(0,1)\)</span> 取 <span class="math inline">\(X=g(U)=\sqrt{-2\sigma^2\ln(1-U)},X^{&#39;}=g(1-U)=\sqrt{-2\sigma^2\ln(U)},\
U\sim U(0,1)\)</span>，故 <span class="math inline">\(1-U\)</span>
也服从 <span class="math inline">\(U(0,1)\)</span>。</p>
<p>具体实现代码如下：</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>func_inverse <span class="ot">&lt;-</span> <span class="cf">function</span>(u, sigma){</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>}</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,sigma)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>X.t <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(<span class="dv">1</span><span class="sc">-</span>u,sigma)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,sigma)</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u2,sigma)</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">var</span>((X<span class="sc">+</span>X.t)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">var</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>(v2<span class="sc">-</span>v1)<span class="sc">/</span>v2</span></code></pre></div>
<pre><code>## [1] 0.9478532</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">c</span>(v1,v2)</span></code></pre></div>
<pre><code>## [1] 0.01111621 0.21317159</code></pre>
<p>在 <span class="math inline">\(\sigma=1\)</span>
时，大概降低了94%的方差。</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,sigma)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>X.t <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(<span class="dv">1</span><span class="sc">-</span>u,sigma)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,sigma)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u2,sigma)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">var</span>((X<span class="sc">+</span>X.t)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">var</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>(v2<span class="sc">-</span>v1)<span class="sc">/</span>v2</span></code></pre></div>
<pre><code>## [1] 0.9476991</code></pre>
<p><span class="math inline">\(\sigma=5\)</span> 时与 <span class="math inline">\(\sigma=1\)</span> 时差异不大。</p>
</div>
<div id="exercise-3---5.13" class="section level2">
<h2>Exercise 3 - 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, ∞)\)</span> and are ‘close’ to <span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2π}} e^{−x^2/2}, x&gt; 1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^\infty\frac{x^2}{\sqrt{2π}} e^{−x^2/2}dx
\]</span> by importance sampling? Explain.</p>
<p>解：记 <span class="math inline">\(A =
\int_1^\infty\frac{x^2}{\sqrt{2π}} e^{−x^2/2}dx\)</span> 取</p>
<ul>
<li><p><span class="math inline">\(f_1(x)=xe^{-x^2/2},x\ge0\)</span>，则
<span class="math display">\[
A=\int_0^\infty\frac{g(x)I(x&gt;1)}{f_1(x)}f_1(x)dx=\int_0^\infty\frac{xI(x&gt;1)}{\sqrt{2\pi}}f_1(x)dx=E\left(\frac{X\cdot
I(X&gt;1)}{\sqrt{2\pi}}\right),\ X\sim f_1(x)
\]</span> 因此 <span class="math inline">\(\hat
A^{(1)}=\frac1{n\sqrt{2\pi}}\sum_{i=1}^nx_i\cdot
I(x_i&gt;1),x_i\overset{i.i.d}{\sim}f_1\)</span></p></li>
<li><p><span class="math inline">\(f_2(x)=\frac{1}{\sqrt{2π}} e^{−x^2/2}
= N(0,1)\)</span>，同理知 <span class="math inline">\(A=E\left[X^2\cdot
I(X&gt;1)\right],\ X\sim f_2(x)\)</span> 即 <span class="math inline">\(\hat A^{(2)}=\frac1{n}\sum_{i=1}^nx_i^2\cdot
I(x_i&gt;1),x_i\overset{i.i.d}{\sim}f_2\)</span></p></li>
</ul>
<p>具体实现代码如下：</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>A.hat<span class="fl">.1</span> <span class="ot">&lt;-</span> A.hat<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">func_inverse</span>(u,<span class="dv">1</span>)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>    A.hat<span class="fl">.1</span>[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x1<span class="sc">*</span>(x1<span class="sc">&gt;</span><span class="dv">1</span>))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>    A.hat<span class="fl">.2</span>[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(x2<span class="sc">&gt;</span><span class="dv">1</span>))</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>}</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(A.hat<span class="fl">.1</span>),<span class="fu">var</span>(A.hat<span class="fl">.2</span>))</span></code></pre></div>
<pre><code>## [1] 2.841991e-05 2.919128e-04</code></pre>
<p>不难看出，使用 <span class="math inline">\(f_1\)</span>
方差更小，这与理论保持一致，即 <span class="math inline">\(f_1\)</span>
与 <span class="math inline">\(g\)</span> 的线性关系更强。</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(A.hat<span class="fl">.1</span>),<span class="fu">mean</span>(A.hat<span class="fl">.2</span>))</span></code></pre></div>
<pre><code>## [1] 0.4008309 0.4011237</code></pre>
</div>
<div id="exercise-4" class="section level2">
<h2>Exercise 4</h2>
<p>Monte Carlo experiment</p>
<ol style="list-style-type: decimal">
<li>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to randomly
permuted numbers of 1, . . . , n.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n\)</span> := n log(n), and graphically show the
results (scatter plot and regression line).</li>
</ol>
<p>解：具体实现代码如下：</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>quicksort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">&lt;=</span><span class="dv">1</span>)<span class="fu">return</span>(x)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>    loc <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>    low <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>    high <span class="ot">&lt;-</span> n</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>    <span class="cf">while</span>(low <span class="sc">!=</span> high){</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>        <span class="cf">if</span>(loc <span class="sc">==</span> low){</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>            <span class="cf">if</span>(x[high] <span class="sc">&lt;</span> x[loc]){</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>                tmp <span class="ot">&lt;-</span> x[high]</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>                x[high] <span class="ot">&lt;-</span> x[loc]</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>                x[loc] <span class="ot">&lt;-</span> tmp</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>                low <span class="ot">=</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>                loc <span class="ot">=</span> high</span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>            }<span class="cf">else</span>{</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>                high <span class="ot">=</span> high <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>            }</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>        }<span class="cf">else</span>{</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>            <span class="cf">if</span>(x[low] <span class="sc">&gt;</span> x[loc]){</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>                tmp <span class="ot">&lt;-</span> x[low]</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>                x[low] <span class="ot">&lt;-</span> x[loc]</span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>                x[loc] <span class="ot">&lt;-</span> tmp</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>                high <span class="ot">=</span> high <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>                loc <span class="ot">=</span> low</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>            }<span class="cf">else</span>{</span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>                low <span class="ot">=</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>            }</span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>        }</span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>    }</span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>    L <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>    R <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>    <span class="cf">if</span>(low<span class="sc">&gt;</span><span class="dv">1</span>) L <span class="ot">=</span> x[<span class="dv">1</span><span class="sc">:</span>(low<span class="dv">-1</span>)]</span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>    <span class="cf">if</span>(low<span class="sc">&lt;</span><span class="fu">length</span>(x)) R <span class="ot">=</span> x[(low<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quicksort</span>(L),x[low],<span class="fu">quicksort</span>(R)))</span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a>}</span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>fast_sorted <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a>    <span class="co"># 生成 1~n 个乱序不重复数字</span></span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a>    random_num <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,n)</span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a>    start.time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a>    </span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a>    <span class="fu">quicksort</span>(random_num)</span>
<span id="cb36-43"><a href="#cb36-43" tabindex="-1"></a>    </span>
<span id="cb36-44"><a href="#cb36-44" tabindex="-1"></a>    end.time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb36-45"><a href="#cb36-45" tabindex="-1"></a>    <span class="fu">return</span>(end.time<span class="sc">-</span>start.time)</span>
<span id="cb36-46"><a href="#cb36-46" tabindex="-1"></a>}</span>
<span id="cb36-47"><a href="#cb36-47" tabindex="-1"></a>n_li <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)</span>
<span id="cb36-48"><a href="#cb36-48" tabindex="-1"></a>a_n <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)  <span class="co"># 长度为 5 的零向量</span></span>
<span id="cb36-49"><a href="#cb36-49" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb36-50"><a href="#cb36-50" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb36-51"><a href="#cb36-51" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n_li[index]</span>
<span id="cb36-52"><a href="#cb36-52" tabindex="-1"></a>    t_li <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb36-53"><a href="#cb36-53" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb36-54"><a href="#cb36-54" tabindex="-1"></a>        t_li[i] <span class="ot">&lt;-</span> <span class="fu">fast_sorted</span>(n)</span>
<span id="cb36-55"><a href="#cb36-55" tabindex="-1"></a>    }</span>
<span id="cb36-56"><a href="#cb36-56" tabindex="-1"></a>    a_n[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(t_li)</span>
<span id="cb36-57"><a href="#cb36-57" tabindex="-1"></a>}</span>
<span id="cb36-58"><a href="#cb36-58" tabindex="-1"></a>md <span class="ot">&lt;-</span> <span class="fu">lm</span>(a_n<span class="sc">~</span>n_li<span class="sc">*</span><span class="fu">log</span>(n_li))</span>
<span id="cb36-59"><a href="#cb36-59" tabindex="-1"></a><span class="fu">summary</span>(md)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a_n ~ n_li * log(n_li))
## 
## Residuals:
##          1          2          3          4          5 
## -7.669e-05  2.784e-04 -5.383e-04  5.100e-04 -1.733e-04 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)     5.963e-02  7.934e-02   0.752    0.590
## n_li            4.035e-06  3.829e-06   1.054    0.483
## log(n_li)      -7.200e-03  9.655e-03  -0.746    0.592
## n_li:log(n_li)  2.592e-08  3.068e-07   0.084    0.946
## 
## Residual standard error: 0.0008144 on 1 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 2.814e+04 on 3 and 1 DF,  p-value: 0.004382</code></pre>
<p>不难看出，<span class="math inline">\(a_n\)</span> 对 <span class="math inline">\(n\log(n)\)</span> 的回归效果很好，<span class="math inline">\(R^2\)</span>
接近1，此外，从下面的散点图和拟合曲线中也容易验证这点。</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">plot</span>(n_li,a_n)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">lines</span>(n_li, <span class="fu">predict</span>(md,<span class="fu">data.frame</span>(<span class="at">x=</span>n_li<span class="sc">*</span><span class="fu">log</span>(n_li))), <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework---3" class="section level1">
<h1>Homework - 3</h1>
<div id="exercise-1---6.6" class="section level2">
<h2>Exercise 1 - 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1} ≈
N(0, 6/n)\)</span>.</p>
<p>解：实现思路为：</p>
<ul>
<li>给定参数m，n，<span class="math inline">\(\mu\)</span>，<span class="math inline">\(\sigma\)</span>；</li>
<li>循环执行<span class="math inline">\((j=1,\cdots,m)\)</span>
<ul>
<li>生成样本 <span class="math inline">\(x_{1}^{(j)},\cdots,x_{n}^{(j)}\overset{i.i.d}\sim
N(\mu,\sigma^2)\)</span></li>
<li>计算估计量 <span class="math inline">\(\hat\mu^{(j)}=\frac1n\sum
x_i^{(j)},\hat\sigma^{(j)}=\sqrt{\frac1{n-1}\sum(x_i^{(j)}-\hat\mu^{(j)})^2},\)</span>
<span class="math inline">\(\hat{SK}^{(j)}=\frac1{n{\hat\sigma^{(j)}}^3}\sum(x_i^{j}-\hat\mu^{(j)})^3\)</span></li>
</ul></li>
<li>计算 <span class="math inline">\(\{\hat{SK}^{(j)}\}\)</span>
的分位数及相应标准差 <span class="math inline">\(\text{Sd}(\hat{SK}_q)=\sqrt{\frac{q(1-q)}{mf(\hat{SK}_q)^2}}\)</span>，其中
<span class="math inline">\(f(\cdot)\)</span>
为标准正态分布的密度函数；</li>
<li>计算大样本下的近似分位数并与蒙特卡罗估计值对比。</li>
</ul>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mu,sigma){<span class="fu">rnorm</span>(n,mu,sigma)}</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>calculate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(sample.x){</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample.x)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample.x)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>    SK <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span><span class="fu">sum</span>((sample.x<span class="sc">-</span>mu)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>    <span class="fu">return</span>(SK)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>}</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>show_data <span class="ot">&lt;-</span> <span class="cf">function</span>(SK.li, q.li, m, n){</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>    hat.SK.q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(SK.li,q.li)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>    sd.Sk.q <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(q.li<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q.li)<span class="sc">/</span>m<span class="sc">/</span><span class="fu">dnorm</span>(hat.SK.q)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>    SK.q_large <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qnorm</span>(q.li)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>    <span class="fu">return</span> (<span class="fu">data.frame</span>(<span class="st">&#39;large.sample&#39;</span><span class="ot">=</span>SK.q_large,<span class="st">&#39;estimate&#39;</span><span class="ot">=</span>hat.SK.q,<span class="st">&#39;estimate.sd&#39;</span><span class="ot">=</span>sd.Sk.q))</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>}</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>hat.SK <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>q.li <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>    sample.j <span class="ot">&lt;-</span> <span class="fu">get_data</span>(n,mu,sigma)</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>    hat.SK[j] <span class="ot">&lt;-</span> <span class="fu">calculate_data</span>(sample.j)</span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>}</span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a><span class="fu">show_data</span>(hat.SK,q.li,m,n)</span></code></pre></div>
<pre><code>##       large.sample    estimate estimate.sd
## 2.5%   -0.02147033 -0.02019522  0.01237801
## 5%     -0.01801847 -0.01740953  0.01727836
## 95%     0.01801847  0.01826771  0.01727863
## 97.5%   0.02147033  0.02189298  0.01237845</code></pre>
<p>容易看出，估计的分位数与对应大样本近似值差异不大。</p>
</div>
<div id="exercise-2---6.b" class="section level2">
<h2>Exercise 2 - 6.B</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(ρ\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(ρ_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(τ\)</span>, are implemented in
cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(ρ_s\)</span> or <span class="math inline">\(τ\)</span> are less powerful than the correlation
test when the sampled distribution is bivariate normal. Find an example
of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
<p>解：展示在二元正态下皮尔逊相关性检验优于其他两种非参数检验，具体思路如下：</p>
<ul>
<li>给定参数m，n，<span class="math inline">\(\rho=0\)</span>，<span class="math inline">\(\alpha\)</span></li>
<li>循环 <span class="math inline">\((j=1,\cdots,m)\)</span>
<ul>
<li>生成样本 <span class="math inline">\(x_1^{(j)},\cdots,x_n^{(j)},y_1^{(j)},\cdots,y_n^{(j)}\overset{i.i.d}\sim
N(0,1)\)</span></li>
<li>分别进行三种检验，得到相应的p-value：<span class="math inline">\(p_1^{(j)},p_2^{(j)},p_3^{(j)}\)</span></li>
</ul></li>
<li>计算 <span class="math inline">\(\text{t1e.i} =
\frac1m\sum_{j=1}^mI(p_i^{(j)}\le\alpha),\
i=1,2,3\)</span>，并进行比较。</li>
</ul>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>}</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>calculate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(sample.x,sample.y){</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> sample.x</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> sample.y</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&#39;pearson&#39;</span>)<span class="sc">$</span>p.value</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>    p2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&#39;kendall&#39;</span>)<span class="sc">$</span>p.value</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>    p3 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)<span class="sc">$</span>p.value</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p1=</span>p1,<span class="at">p2=</span>p2,<span class="at">p3=</span>p3))</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>}</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>show_data <span class="ot">&lt;-</span> <span class="cf">function</span>(p1.li,p2.li,p3.li, alpha){</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">mean</span>(p1.li<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(p2.li<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(p3.li<span class="sc">&lt;=</span>alpha))</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>}</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">5e4</span></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>    sample.j <span class="ot">&lt;-</span> <span class="fu">get_data</span>(n)</span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>    x <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>x</span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>    y <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>y</span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a>    p.j <span class="ot">&lt;-</span> <span class="fu">calculate_data</span>(x,y)</span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>    p1[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p1</span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a>    p2[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p2</span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a>    p3[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p3</span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a>}</span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a><span class="fu">show_data</span>(p1,p2,p3,alpha)</span></code></pre></div>
<pre><code>## [1] 0.04924 0.04574 0.04824</code></pre>
<p>容易看出，此时，皮尔逊相关系数检验的t1e最接近于0.05。</p>
<p>在上述循环过程中，将数据生成过程改为</p>
<ul>
<li><span class="math inline">\(y_1^{(j)},\cdots,y_n^{(j)}\overset{i.i.d}\sim
exp(1),z_1^{(j)},\cdots,z_n^{(j)}\overset{i.i.d}\sim t(2)\)</span></li>
<li><span class="math inline">\(x_i^{(j)}=1+1.5\sqrt{y_i^{(j)}}+z_i^{(j)},\
i=1,\cdots,n\)</span></li>
</ul>
<p>即可使得非参数检验的功效优于皮尔逊相关系数检验，具体实现代码如下：</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>y<span class="sc">^</span>{<span class="fl">0.5</span>} <span class="sc">+</span> <span class="fu">rt</span>(n,<span class="dv">2</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>}</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">5e3</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>    sample.j <span class="ot">&lt;-</span> <span class="fu">get_data</span>(n)</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>    x <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>x</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>y</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>    p.j <span class="ot">&lt;-</span> <span class="fu">calculate_data</span>(x,y)</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>    p1[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p1</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>    p2[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p2</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>    p3[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p3</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>}</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a><span class="fu">show_data</span>(p1,p2,p3,alpha)</span></code></pre></div>
<pre><code>## [1] 0.7470 0.9900 0.9894</code></pre>
<p>两种非参数检验的功效大概为0.98，均大于皮尔逊相关系数检验的功效(0.75)。</p>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise 3</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level.</p>
<ul>
<li>What is the corresponding hypothesis test problem?</li>
<li>What test should we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</li>
<li>Please provide the least necessary information for hypothesis
testing.</li>
</ul>
<p>解：(1)用 <span class="math inline">\(p_1,p_2\)</span>
表示两种方法的功效，则相应假设检验(<span class="math inline">\(\alpha=0.05\)</span>)为 <span class="math display">\[
H_0:p_1=p_2\ \text{vs}\ H_1:p_1\ne p_2
\]</span> (2)采用Z-test。 记 <span class="math inline">\(X\sim
B(1,p_1),Y\sim B(1,p_2),n=10000\)</span>，大样本下近似有 <span class="math display">\[
\bar x\dot\sim N\left(p_1,\frac{p_1(1-p_1)}n\right),\bar y\dot\sim
N\left(p_2,\frac{p_2(1-p_2)}n\right)
\]</span> 在 <span class="math inline">\(H_0\)</span>
成立的条件下，近似有 <span class="math display">\[
z = \frac{\bar x-\bar y}{\sqrt{\frac{2\hat p(1-\hat p)}{n}}}\dot\sim
N(0,1)
\]</span> 其中 <span class="math inline">\(\hat
p=\frac{0.651+0.676}{2}=0.6635\)</span>。</p>
<ol start="3" style="list-style-type: decimal">
<li>根据(2)中方法，计算出检验统计量 <span class="math inline">\(z\)</span> 和对应的p.value，其实现代码如下</li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>x.bar <span class="ot">&lt;-</span> <span class="fl">0.651</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>y.bar <span class="ot">&lt;-</span> <span class="fl">0.676</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fl">0.6635</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x.bar<span class="sc">-</span>y.bar)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>n)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">min</span>(<span class="fu">pnorm</span>(z),<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(z))</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>p.value</span></code></pre></div>
<pre><code>## [1] 0.0001831369</code></pre>
<p>因为 <span class="math inline">\(p.value=0.00018&lt;\alpha=0.05\)</span>，拒绝原假设。</p>
</div>
</div>
<div id="homework---4" class="section level1">
<h1>Homework - 4</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise 1</h2>
<p>Of N = 1000 hypotheses, 950 are null and 50 are alternative.The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level <span class="math inline">\(\alpha =
0.1\)</span> for each of the two adjustment methods based on m = 10000
simulation replicates. You should output the 6 numbers (3) to a 3 × 2
table (column names: Bonferroni correction, B-H correction; row names:
FWER, FDR, TPR).Comment the results.</p>
<p>解：其实现代码如下所示：</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>calculate.Bonferroni <span class="ot">&lt;-</span> <span class="cf">function</span>(p0.value, pa.value, alpha){</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>    n0 <span class="ot">&lt;-</span> <span class="fu">length</span>(p0.value)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>    na <span class="ot">&lt;-</span> <span class="fu">length</span>(pa.value)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>    N <span class="ot">&lt;-</span> n0<span class="sc">+</span>na</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>    V <span class="ot">&lt;-</span> <span class="fu">sum</span>(p0.value<span class="sc">&lt;</span>alpha<span class="sc">/</span>N)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>    <span class="co"># U &lt;- n0-V</span></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>    S <span class="ot">&lt;-</span> <span class="fu">sum</span>(pa.value<span class="sc">&lt;</span>alpha<span class="sc">/</span>N)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>    <span class="co"># T &lt;- na-S</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>    TPR <span class="ot">&lt;-</span> S<span class="sc">/</span>na</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>    FDR <span class="ot">&lt;-</span> V<span class="sc">/</span>(V<span class="sc">+</span>S)</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>    FWER <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>    <span class="cf">if</span> (V<span class="sc">&gt;=</span><span class="dv">1</span>) FWER <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(FWER,FDR,TPR))</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>}</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>calculate.BH <span class="ot">&lt;-</span> <span class="cf">function</span>(p0.value, pa.value, alpha){</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>    new.p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(<span class="at">p=</span><span class="fu">c</span>(p0.value,pa.value),<span class="at">method =</span> <span class="st">&#39;BH&#39;</span>)</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>    n0 <span class="ot">&lt;-</span> <span class="fu">length</span>(p0.value)</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>    na <span class="ot">&lt;-</span> <span class="fu">length</span>(pa.value)</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>    V <span class="ot">&lt;-</span> <span class="fu">sum</span>(new.p[<span class="dv">1</span><span class="sc">:</span>n0]<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>    S <span class="ot">&lt;-</span> <span class="fu">sum</span>(new.p[(n0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n0<span class="sc">+</span>na)]<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>    TPR <span class="ot">&lt;-</span> S<span class="sc">/</span>na</span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>    FDR <span class="ot">&lt;-</span> V<span class="sc">/</span>(V<span class="sc">+</span>S)</span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>    FWER <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>    <span class="cf">if</span> (V<span class="sc">&gt;=</span><span class="dv">1</span>) FWER <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(FWER,FDR,TPR))</span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>}</span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>one.simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>    n0 <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>    na <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>    p0.value <span class="ot">&lt;-</span> <span class="fu">runif</span>(n0)</span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a>    pa.value <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(na,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a>    out1 <span class="ot">&lt;-</span> <span class="fu">calculate.Bonferroni</span>(p0.value,pa.value,alpha)</span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a>    out2 <span class="ot">&lt;-</span> <span class="fu">calculate.BH</span>(p0.value,pa.value,alpha)</span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(out1,out2))</span>
<span id="cb47-37"><a href="#cb47-37" tabindex="-1"></a>}</span>
<span id="cb47-38"><a href="#cb47-38" tabindex="-1"></a>show.table <span class="ot">&lt;-</span> <span class="cf">function</span>(nm, row_names, column_names){</span>
<span id="cb47-39"><a href="#cb47-39" tabindex="-1"></a>    nv <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(nm)</span>
<span id="cb47-40"><a href="#cb47-40" tabindex="-1"></a>    out.m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(nv,<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb47-41"><a href="#cb47-41" tabindex="-1"></a>    <span class="fu">colnames</span>(out.m) <span class="ot">&lt;-</span> column_names</span>
<span id="cb47-42"><a href="#cb47-42" tabindex="-1"></a>    <span class="fu">rownames</span>(out.m) <span class="ot">&lt;-</span> row_names</span>
<span id="cb47-43"><a href="#cb47-43" tabindex="-1"></a>    <span class="fu">return</span>(out.m)</span>
<span id="cb47-44"><a href="#cb47-44" tabindex="-1"></a>}</span>
<span id="cb47-45"><a href="#cb47-45" tabindex="-1"></a>row_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;FWER&#39;</span>, <span class="st">&#39;FDR&#39;</span>, <span class="st">&#39;TPR&#39;</span>)</span>
<span id="cb47-46"><a href="#cb47-46" tabindex="-1"></a>column_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Bonferroni correction&#39;</span>, <span class="st">&#39;B-H correction&#39;</span>)</span>
<span id="cb47-47"><a href="#cb47-47" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10086</span>)</span>
<span id="cb47-48"><a href="#cb47-48" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb47-49"><a href="#cb47-49" tabindex="-1"></a>need.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol =</span> <span class="dv">6</span>,<span class="at">nrow=</span>m)</span>
<span id="cb47-50"><a href="#cb47-50" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb47-51"><a href="#cb47-51" tabindex="-1"></a>    need.vector <span class="ot">&lt;-</span> <span class="fu">one.simulation</span>()</span>
<span id="cb47-52"><a href="#cb47-52" tabindex="-1"></a>    need.matrix[i,] <span class="ot">&lt;-</span> need.vector</span>
<span id="cb47-53"><a href="#cb47-53" tabindex="-1"></a>}</span>
<span id="cb47-54"><a href="#cb47-54" tabindex="-1"></a>out.table <span class="ot">&lt;-</span> <span class="fu">show.table</span>(need.matrix,row_names, column_names)</span>
<span id="cb47-55"><a href="#cb47-55" tabindex="-1"></a>out.table</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER           0.089800000     0.92660000
## FDR            0.004547063     0.09492578
## TPR            0.398626000     0.56160600</code></pre>
<p>如上表所示，Bonferroni correction方法控制了FWER，使其更小；但B-H
correction方法的FDR和TPR更大。</p>
</div>
<div id="exercise-2---7.4" class="section level2">
<h2>Exercise 2 - 7.4</h2>
<p>Refer to the air-conditioning data set <code>aircondit</code>
provided in the <code>boot</code> package. The 12 observations are the
times in hours between failures of air-conditioning equipment [63,
Example 1.1]:</p>
<p>3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487.</p>
<p>Assume that the times between failures follow an exponential model
Exp(<span class="math inline">\(\lambda\)</span>).Obtain the MLE of the
hazard rate <span class="math inline">\(\lambda\)</span> and use
bootstrap to estimate the bias and standard error of the estimate.</p>
<p>解：易知 <span class="math inline">\(\hat\lambda_{MLE}=\frac1{\bar
X}\)</span>，使用自举法估计偏差和标准差的代码如下：</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(aircondit))</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>);thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(data)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>    d1.star <span class="ot">&lt;-</span> <span class="fu">sample</span>(data,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>    thetastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(d1.star)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>}</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">mean.boot=</span><span class="fu">mean</span>(thetastar),<span class="at">bias=</span><span class="fu">mean</span>(thetastar)<span class="sc">-</span>theta,<span class="at">se.boot=</span><span class="fu">sd</span>(thetastar)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## mean.boot      bias   se.boot 
##    0.0106    0.0013    0.0043</code></pre>
</div>
<div id="exercise-3---7.5" class="section level2">
<h2>Exercise 3 - 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/<span class="math inline">\(\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>boot.theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>data,<span class="at">statistic=</span>boot.theta, <span class="at">R =</span> B)</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="fu">mean</span>(de<span class="sc">$</span>t)</span></code></pre></div>
<pre><code>## [1] 108.0022</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>out.data <span class="ot">&lt;-</span> <span class="cf">function</span>(boot_ci){</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>    ci <span class="ot">&lt;-</span> boot_ci</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">c</span>(ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(d,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>    <span class="fu">colnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;下界&#39;</span>,<span class="st">&#39;上界&#39;</span>)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>    <span class="fu">rownames</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>    <span class="fu">return</span>(m)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>}</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">out.data</span>(ci)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>##           下界     上界
## norm  34.07491 182.2540
## basic 23.83542 169.8333
## perc  46.33333 192.3312
## bca   57.15242 224.1078</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">rowMeans</span>(m)</span></code></pre></div>
<pre><code>##      norm     basic      perc       bca 
## 108.16447  96.83438 119.33229 140.63010</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>m[,<span class="dv">2</span>]<span class="sc">-</span>m[,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>##     norm    basic     perc      bca 
## 148.1791 145.9979 145.9979 166.9554</code></pre>
<p>从区间估计的对称轴来看，standard
normal方法最接近统计量的均值，bca方法离统计量的均值最远；从区间估计的长度来看，basic方法和perc方法一致且最短，bca方法最长。这四种方法之间的差异来源于其计算时基于的分布不同，其中standard
normal方法基于正态分布，basic方法和perc方法基于抽样统计量的分布(理论上它们的区间长度也应一致)，bca方法虽然也居于正态分布，但其分位点进行了某种修正。</p>
</div>
</div>
<div id="class-work" class="section level1">
<h1>Class work</h1>
<p>Use the bootstrap method (R = 10000) to calculate the sample mean
difference for comparing the following two independent samples:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, </span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>            <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>);</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>,  <span class="fl">0.878</span>,  <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>,  </span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>             <span class="fl">0.680</span>, <span class="fl">2.280</span>,  <span class="fl">2.390</span>, <span class="fl">1.793</span>,  <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span></code></pre></div>
<p>The outputs should include original statistic, sample standard error,
and bootstrap standard error.</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>, <span class="fl">0.878</span>, <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>, <span class="fl">0.680</span>, <span class="fl">2.280</span>, <span class="fl">2.390</span>, <span class="fl">1.793</span>, <span class="fl">8.091</span>, <span class="fl">1.468</span>)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>);thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1)<span class="sc">-</span><span class="fu">mean</span>(d2);</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>    d1.star <span class="ot">&lt;-</span> <span class="fu">sample</span>(d1,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>    d2.star <span class="ot">&lt;-</span> <span class="fu">sample</span>(d2,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>    thetastar[b] <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1.star)<span class="sc">-</span><span class="fu">mean</span>(d2.star)</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>}</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">mean.boot=</span><span class="fu">mean</span>(thetastar),<span class="at">bias=</span><span class="fu">mean</span>(thetastar)<span class="sc">-</span>theta,<span class="at">se.boot=</span><span class="fu">sd</span>(thetastar),<span class="at">se.samp=</span><span class="fu">sqrt</span>(<span class="fu">var</span>(d1)<span class="sc">/</span><span class="fu">length</span>(d1)<span class="sc">+</span><span class="fu">var</span>(d2)<span class="sc">/</span><span class="fu">length</span>(d2))),<span class="dv">3</span>)  </span></code></pre></div>
<pre><code>## mean.boot      bias   se.boot   se.samp 
##    -2.689     0.000     0.704     0.739</code></pre>
</div>
<div id="homework---5" class="section level1">
<h1>Homework - 5</h1>
<div id="exercise-1---7.8" class="section level2">
<h2>Exercise 1 - 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<p>解：记 <span class="math inline">\(\Bbb
Y=(X_1,X_2,\cdots,X_5)^\tau,\Sigma=cov(\Bbb
Y),\lambda_1&gt;\cdots&gt;\lambda_5&gt;0\)</span> 为矩阵 <span class="math inline">\(\Sigma\)</span> 的特征值，待估参数 <span class="math inline">\(\theta=\frac{\lambda_1}{\sum_{i=1}^5\lambda_i}\)</span>，则
<span class="math inline">\(\hat\theta=\frac{\hat\lambda_1}{\sum_{i=1}^5\hat\lambda_i}\)</span>，其中
<span class="math inline">\(\hat\lambda_i\)</span> 为 <span class="math inline">\(\Sigma\)</span> 的MLE估计 <span class="math inline">\(\hat \Sigma\)</span>的特征值，使用刀切法估计 <span class="math inline">\(\hat\theta\)</span> 的偏差和标准差的步骤为：</p>
<ul>
<li>样本 <span class="math inline">\(\Bbb Y_1,\cdots,\Bbb
Y_{n},n=88\)</span>；</li>
<li>对于 <span class="math inline">\(i = 1,\cdots,n\)</span> 重复：
<ul>
<li>使用样本 <span class="math inline">\(\{\Bbb Y_1,\cdots,\Bbb
Y_{i-1},\cdots,\Bbb Y_{i+1},\cdots,\Bbb Y_{n}\}\)</span> 估计 <span class="math inline">\(\hat \Sigma_{(i)}\)</span></li>
<li>计算 <span class="math inline">\(\hat \Sigma_{(i)}\)</span>
对应特征值 <span class="math inline">\(\hat\lambda_j^{(i)},1\le j\le
5\)</span> 及 <span class="math inline">\(\hat\theta_{(i)}\)</span></li>
</ul></li>
<li>使用 <span class="math inline">\(\{\hat\theta_{(i)},1\le i \le
n\}\)</span> 序列计算估计量的偏差和标准差。</li>
</ul>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>calculate.func <span class="ot">&lt;-</span> <span class="cf">function</span>(input.data){</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">cov</span>(input.data)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>    lambda.vc <span class="ot">&lt;-</span> <span class="fu">eigen</span>(m)<span class="sc">$</span>values</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>    theta.hat <span class="ot">&lt;-</span> lambda.vc[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.vc)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>    <span class="fu">return</span>(theta.hat)</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>}</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">calculate.func</span>(scor)</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">88</span>){</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>    theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">calculate.func</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>}</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<p>即 <span class="math inline">\(\hat\theta\)</span> 的偏度为 <span class="math inline">\(0.001\)</span>，标准差为 <span class="math inline">\(0.05\)</span>。</p>
</div>
<div id="exercise-2---7.10" class="section level2">
<h2>Exercise 2 - 7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<p>解：参考例7.18，其实现代码如下：</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>    e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>    e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>    e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb66-20"><a href="#cb66-20" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb66-21"><a href="#cb66-21" tabindex="-1"></a>    e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb66-22"><a href="#cb66-22" tabindex="-1"></a>}</span>
<span id="cb66-23"><a href="#cb66-23" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># adjusted R^2</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>adj.r.squared1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>adj.r.squared2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>adj.r.squared3 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J3)<span class="sc">$</span>adj.r.squared</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>adj.r.squared4 <span class="ot">&lt;-</span> <span class="fu">summary</span>(J4)<span class="sc">$</span>adj.r.squared</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a><span class="fu">c</span>(adj.r.squared1,adj.r.squared2,adj.r.squared3,adj.r.squared4)</span></code></pre></div>
<pre><code>## [1] 0.5281545 0.5768151 0.5280556 0.5740396</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<p>即使用留一交叉验证最终选择模型二，使用调整后的R^2最终选择模型二。</p>
</div>
<div id="exercise-3---8.1" class="section level2">
<h2>Exercise 3 - 8.1</h2>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<p>解：Cramer-von Mises统计量计算公式为 <span class="math display">\[
W_2=\frac{mn}{(m+n)^2}\left[
    \sum_{i=1}^n(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^m(F_n(y_j)-G_m(y_j))^2\right]
\]</span> 其中 <span class="math inline">\(F_n\)</span> 为 <span class="math inline">\(x_1,\ldots,x_n\)</span> 的经验分布函数，<span class="math inline">\(G_m\)</span> 为 <span class="math inline">\(y_1,\ldots,y_m\)</span> 的经验分布函数；</p>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>all.x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>all.y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>calculate.statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(datax,datay){</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(datax)</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">length</span>(datay)</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>    Fn <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(datax)</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>    Gm <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(datay)</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>    part1 <span class="ot">=</span> <span class="fu">sum</span>((<span class="fu">Fn</span>(datax)<span class="sc">-</span><span class="fu">Gm</span>(datax))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>    part2 <span class="ot">=</span> <span class="fu">sum</span>((<span class="fu">Fn</span>(datay)<span class="sc">-</span><span class="fu">Gm</span>(datay))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>    out <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(part1<span class="sc">+</span>part2)</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>}</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(all.x, all.y)</span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(all.x)</span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">calculate.statistic</span>(all.x,all.y)</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z);</span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a>    reps[i] <span class="ot">&lt;-</span> <span class="fu">calculate.statistic</span>(x1,y1)</span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a>}</span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb71-30"><a href="#cb71-30" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.410059</code></pre>
<p>p值为0.41，不拒绝原假设。</p>
</div>
<div id="exercise-4---8.2" class="section level2">
<h2>Exercise 4 - 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function <code>cor</code> with
method = “spearman”. Compare the achieved significance level of the
permutation test with the p-value reported by cor.test on the same
samples.</p>
<p>解：统计量计算方式为<code>cor(X,Y,method = &#39;spearman&#39;)</code>，其实现代码如下：</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>calculate.statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(datax,datay){</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>    <span class="fu">cor</span>(datax,datay,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>}</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>all.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">44.4</span>, <span class="fl">45.9</span>, <span class="fl">41.9</span>, <span class="fl">53.3</span>, <span class="fl">44.7</span>, <span class="fl">44.1</span>, <span class="fl">50.7</span>, <span class="fl">45.2</span>, <span class="fl">60.1</span>)</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>all.y <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fl">2.6</span>,  <span class="fl">3.1</span>,  <span class="fl">2.5</span>,  <span class="fl">5.0</span>,  <span class="fl">3.6</span>,  <span class="fl">4.0</span>,  <span class="fl">5.2</span>,  <span class="fl">2.8</span>,  <span class="fl">3.8</span>)</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">9999</span></span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(all.x, all.y)</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(all.x)</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">calculate.statistic</span>(all.x,all.y)</span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a>    reps[i] <span class="ot">&lt;-</span> <span class="fu">calculate.statistic</span>(all.x,<span class="fu">sample</span>(all.y))</span>
<span id="cb73-14"><a href="#cb73-14" tabindex="-1"></a>}</span>
<span id="cb73-15"><a href="#cb73-15" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb73-16"><a href="#cb73-16" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.1037</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">cor.test</span>(all.x,all.y)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  all.x and all.y
## t = 1.8411, df = 7, p-value = 0.1082
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.1497426  0.8955795
## sample estimates:
##       cor 
## 0.5711816</code></pre>
<p>两种方法计算出来的p值基本一致，大概为0.1，不拒绝原假设。</p>
</div>
</div>
<div id="homework---6" class="section level1">
<h1>Homework - 6</h1>
<div id="exercise-1---9.3" class="section level2">
<h2>Exercise 1 - 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see <code>qcauchy</code> or
<code>qt</code> with df=1). Recall that a Cauchy(<span class="math inline">\(\theta\)</span>, <span class="math inline">\(\eta\)</span>) distribution has density function
<span class="math display">\[
f(x) = \frac1{θπ(1 + [(x − η)/θ]^2)}, \ −\infty &lt;x&lt; \infty,
\theta&gt; 0.
\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta\)</span> = 1, <span class="math inline">\(\eta\)</span> = 0) density. (Note that the
standard Cauchy density is equal to the Student t density with one
degree of freedom.)</p>
<p>解：选择 <span class="math inline">\(g(\cdot|X)\)</span> 为自由度为
<span class="math inline">\(X\)</span>
的t分布的密度函数，则M-H采样的步骤为：</p>
<ul>
<li>从 <code>t(df=1)</code> 分布中生成 <span class="math inline">\(X_1\)</span>；</li>
<li>对于 <span class="math inline">\(i=2,\cdots,N\)</span>，重复：
<ul>
<li>从 <span class="math inline">\(t(df=|X_{i-1}|+0.1)\)</span>
分布中生成 <span class="math inline">\(Y\)</span>;</li>
<li>从 <span class="math inline">\(U(0,1)\)</span> 分布中生成 <span class="math inline">\(U\)</span>;</li>
<li>计算 <span class="math inline">\(β(X_{i−1}, Y ) = \frac{f (Y
)g(X_{i−1}|Y )}{f (X_{i−1})g(Y |X_{i−1})}\)</span>;</li>
<li>生成 <span class="math inline">\(X_i=X_{i-1}\cdot I(U&gt;β(X_{i−1},
Y ))+Y\cdot I(U\leβ(X_{i−1}, Y ))\)</span>;</li>
</ul></li>
<li>得到序列 <span class="math inline">\(\{X_i,1\le i\le
N\}\)</span>。</li>
</ul>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>    <span class="fu">dt</span>(x,<span class="dv">1</span>)</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>}</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>g.X <span class="ot">&lt;-</span> <span class="cf">function</span>(y,x){</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>    <span class="fu">dt</span>(y,<span class="fu">abs</span>(x)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>}</span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>beta.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>    <span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">g.X</span>(x,y)<span class="sc">/</span>(<span class="fu">f</span>(x)<span class="sc">*</span><span class="fu">g.X</span>(y,x))</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>}</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">1</span>,<span class="fu">abs</span>(x0)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">beta.func</span>(x0,Y)</span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>    <span class="cf">if</span> (U<span class="sc">&lt;=</span>beta){</span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a>        X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb77-20"><a href="#cb77-20" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb77-21"><a href="#cb77-21" tabindex="-1"></a>        X[i] <span class="ot">&lt;-</span> x0</span>
<span id="cb77-22"><a href="#cb77-22" tabindex="-1"></a>    }</span>
<span id="cb77-23"><a href="#cb77-23" tabindex="-1"></a>}</span>
<span id="cb77-24"><a href="#cb77-24" tabindex="-1"></a><span class="fu">quantile</span>(X[<span class="dv">3000</span><span class="sc">:</span><span class="dv">5000</span>],(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>##           10%           20%           30%           40%           50% 
## -2.701694e+00 -1.351508e+00 -6.947410e-01 -3.330226e-01  5.041261e-02 
##           60%           70%           80%           90%          100% 
##  3.850206e-01  8.256074e-01  1.435266e+00  3.127315e+00  1.011999e+04</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">qcauchy</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197
##  [7]  0.7265425  1.3763819  3.0776835        Inf</code></pre>
<p>从十分位数来看，两者差异不大。</p>
</div>
<div id="exercise-2---9.8" class="section level2">
<h2>Exercise 2 - 9.8</h2>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x, y) ∝C_n^x y^{x+a−1}(1 − y)^{n−x+b−1}, x = 0, 1,\cdots, n, 0 ≤ y ≤
1.
\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the
conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b).
Use the Gibbs sampler to generate a chain with target joint density f(x,
y).</p>
<p>解：<span class="math inline">\((X,Y)\sim f(x,y)\)</span>，且 <span class="math inline">\(X|Y=y \sim B(n,y),Y|X=x\sim
Beta(x+a,n-x+b)\)</span>，则Gibbs采样步骤为：</p>
<ul>
<li>初始值 <span class="math inline">\(X_1=1,Y_1\)</span> 从 <span class="math inline">\(beta(1+a,n-1+b)\)</span> 中生成；</li>
<li>对于 <span class="math inline">\(i=2,\cdots,N\)</span>，从 <span class="math inline">\(X|Y=Y_{i-1}\)</span> 生成 <span class="math inline">\(X_i\)</span>，从 <span class="math inline">\(Y|X=X_i\)</span> 中生成 <span class="math inline">\(Y_i\)</span>；</li>
</ul>
<p>其实现代码如下所示：</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>x.vc <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>y.vc <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>x.vc[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>y.vc[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="sc">+</span>a,n<span class="dv">-1</span><span class="sc">+</span>b)</span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y.vc[i<span class="dv">-1</span>])</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>    x.vc[i] <span class="ot">&lt;-</span> xi</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>    y.vc[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,xi<span class="sc">+</span>a,n<span class="sc">-</span>xi<span class="sc">+</span>b)</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>}</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a><span class="co"># par(mfcol=c(2,1))</span></span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a><span class="fu">plot</span>(x.vc,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">plot</span>(y.vc,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="co"># par(mfcol=c(1,2))</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="fu">hist</span>(x.vc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">hist</span>(y.vc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3-1" class="section level2">
<h2>Exercise 3</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat R\)</span> &lt; 1.2.</p>
<p>解：对于序列 <span class="math inline">\(\{X_{ij}:1\le i\le k,1\le
j\le n\}\)</span>，有 <span class="math display">\[
B_n=\frac n{k-1}\sum_{i=1}^k(\bar \phi_{i\cdot}-\bar
\phi_{\cdot\cdot})^2,\quad
W_n = \frac 1k\sum_{i=1}^k \frac1{n-1}\sum_{j=1}^n(\phi_{ij}-\bar
\phi_{i\cdot})^2
\]</span> 则 <span class="math inline">\(R_n=1-\frac1n+\frac1n\frac{B_n}{W_n}\)</span>，在上述案例中计算
<span class="math inline">\(R_n\)</span> 序列，其实现代码为：</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co"># Exercise 1</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4000</span></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>calculate.X <span class="ot">&lt;-</span> <span class="cf">function</span>(N, alpha){</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>    f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>        <span class="fu">dt</span>(x,<span class="dv">1</span>)</span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>    }</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>    g.X <span class="ot">&lt;-</span> <span class="cf">function</span>(y,x){</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>        <span class="fu">dt</span>(y,<span class="fu">abs</span>(x)<span class="sc">+</span>alpha)</span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a>    }</span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>    beta.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a>        <span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">g.X</span>(x,y)<span class="sc">/</span>(<span class="fu">f</span>(x)<span class="sc">*</span><span class="fu">g.X</span>(y,x))</span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a>    }</span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a>    X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a>        x0 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a>        Y <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">1</span>,<span class="fu">abs</span>(x0)<span class="sc">+</span>alpha)</span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>        U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>        beta <span class="ot">&lt;-</span> <span class="fu">beta.func</span>(x0,Y)</span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a>        <span class="cf">if</span> (U<span class="sc">&lt;=</span>beta){</span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a>            X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a>        }<span class="cf">else</span>{</span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a>            X[i] <span class="ot">&lt;-</span> x0</span>
<span id="cb85-25"><a href="#cb85-25" tabindex="-1"></a>        }</span>
<span id="cb85-26"><a href="#cb85-26" tabindex="-1"></a>    }</span>
<span id="cb85-27"><a href="#cb85-27" tabindex="-1"></a>    phi <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(X)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb85-28"><a href="#cb85-28" tabindex="-1"></a>    <span class="fu">return</span>(phi)</span>
<span id="cb85-29"><a href="#cb85-29" tabindex="-1"></a>}</span>
<span id="cb85-30"><a href="#cb85-30" tabindex="-1"></a></span>
<span id="cb85-31"><a href="#cb85-31" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb85-32"><a href="#cb85-32" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12314</span>)</span>
<span id="cb85-33"><a href="#cb85-33" tabindex="-1"></a>phi1 <span class="ot">&lt;-</span> <span class="fu">calculate.X</span>(N,<span class="dv">1</span>)</span>
<span id="cb85-34"><a href="#cb85-34" tabindex="-1"></a>phi2 <span class="ot">&lt;-</span> <span class="fu">calculate.X</span>(N,<span class="dv">2</span>)</span>
<span id="cb85-35"><a href="#cb85-35" tabindex="-1"></a>phi3 <span class="ot">&lt;-</span> <span class="fu">calculate.X</span>(N,<span class="dv">3</span>)</span>
<span id="cb85-36"><a href="#cb85-36" tabindex="-1"></a></span>
<span id="cb85-37"><a href="#cb85-37" tabindex="-1"></a>phi.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(phi1,phi2,phi3),<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb85-38"><a href="#cb85-38" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb85-39"><a href="#cb85-39" tabindex="-1"></a>num <span class="ot">&lt;-</span> N<span class="sc">-</span>start</span>
<span id="cb85-40"><a href="#cb85-40" tabindex="-1"></a>Rn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num)</span>
<span id="cb85-41"><a href="#cb85-41" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> start<span class="sc">:</span>(N)){</span>
<span id="cb85-42"><a href="#cb85-42" tabindex="-1"></a>    use.matrix <span class="ot">&lt;-</span> phi.matrix[<span class="dv">1</span><span class="sc">:</span>n,]</span>
<span id="cb85-43"><a href="#cb85-43" tabindex="-1"></a>    Bn <span class="ot">&lt;-</span> n<span class="sc">/</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">colMeans</span>(use.matrix) <span class="sc">-</span> <span class="fu">mean</span>(use.matrix))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb85-44"><a href="#cb85-44" tabindex="-1"></a>    part.matrix <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(use.matrix) <span class="sc">-</span> <span class="fu">colMeans</span>(use.matrix))</span>
<span id="cb85-45"><a href="#cb85-45" tabindex="-1"></a>    Wn <span class="ot">&lt;-</span> <span class="fu">sum</span>(part.matrix<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>k<span class="sc">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb85-46"><a href="#cb85-46" tabindex="-1"></a>    Rn[n<span class="sc">-</span>start<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1-1</span><span class="sc">/</span>n<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n<span class="sc">*</span>(Bn<span class="sc">/</span>Wn)</span>
<span id="cb85-47"><a href="#cb85-47" tabindex="-1"></a>}</span>
<span id="cb85-48"><a href="#cb85-48" tabindex="-1"></a><span class="fu">plot</span>(Rn[<span class="dv">350</span><span class="sc">:</span><span class="dv">750</span>],<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Rn&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># Exercise 2</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>calculate.phi <span class="ot">&lt;-</span> <span class="cf">function</span>(N, alpha){</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>    <span class="co"># N &lt;- 3000</span></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>    x.vc <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>    y.vc <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>    x.vc[<span class="dv">1</span>] <span class="ot">&lt;-</span> alpha</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>    </span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>    y.vc[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,alpha<span class="sc">+</span>a,n<span class="sc">-</span>alpha<span class="sc">+</span>b)</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>        xi <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y.vc[i<span class="dv">-1</span>])</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>        x.vc[i] <span class="ot">&lt;-</span> xi</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>        y.vc[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,xi<span class="sc">+</span>a,n<span class="sc">-</span>xi<span class="sc">+</span>b)</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>    }</span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a>    phi.x <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(x.vc)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>    phi.y <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(y.vc)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">phi.x=</span>phi.x,<span class="at">phi.y=</span>phi.y))</span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>}</span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3000</span></span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12314</span>)</span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">calculate.phi</span>(N,<span class="dv">1</span>)</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a>phi.y1 <span class="ot">&lt;-</span> out<span class="sc">$</span>phi.y</span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a>phi.x1 <span class="ot">&lt;-</span> out<span class="sc">$</span>phi.x</span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">calculate.phi</span>(N,<span class="dv">2</span>)</span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a>phi.y2 <span class="ot">&lt;-</span> out<span class="sc">$</span>phi.y</span>
<span id="cb86-30"><a href="#cb86-30" tabindex="-1"></a>phi.x2 <span class="ot">&lt;-</span> out<span class="sc">$</span>phi.x</span>
<span id="cb86-31"><a href="#cb86-31" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">calculate.phi</span>(N,<span class="dv">3</span>)</span>
<span id="cb86-32"><a href="#cb86-32" tabindex="-1"></a>phi.y3 <span class="ot">&lt;-</span> out<span class="sc">$</span>phi.y</span>
<span id="cb86-33"><a href="#cb86-33" tabindex="-1"></a>phi.x3 <span class="ot">&lt;-</span> out<span class="sc">$</span>phi.x</span>
<span id="cb86-34"><a href="#cb86-34" tabindex="-1"></a></span>
<span id="cb86-35"><a href="#cb86-35" tabindex="-1"></a>phi.x.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(phi.x1,phi.x2,phi.x3),<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb86-36"><a href="#cb86-36" tabindex="-1"></a>phi.y.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(phi.y1,phi.y2,phi.y3),<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb86-37"><a href="#cb86-37" tabindex="-1"></a></span>
<span id="cb86-38"><a href="#cb86-38" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb86-39"><a href="#cb86-39" tabindex="-1"></a>num <span class="ot">&lt;-</span> N<span class="sc">-</span>start</span>
<span id="cb86-40"><a href="#cb86-40" tabindex="-1"></a>Rn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num)</span>
<span id="cb86-41"><a href="#cb86-41" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> start<span class="sc">:</span>(N)){</span>
<span id="cb86-42"><a href="#cb86-42" tabindex="-1"></a>    use.x.matrix <span class="ot">&lt;-</span> phi.x.matrix[<span class="dv">1</span><span class="sc">:</span>n,]</span>
<span id="cb86-43"><a href="#cb86-43" tabindex="-1"></a>    use.y.matrix <span class="ot">&lt;-</span> phi.y.matrix[<span class="dv">1</span><span class="sc">:</span>n,]</span>
<span id="cb86-44"><a href="#cb86-44" tabindex="-1"></a>    Bn.x <span class="ot">&lt;-</span> n<span class="sc">/</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">colMeans</span>(use.x.matrix) <span class="sc">-</span> <span class="fu">mean</span>(use.x.matrix))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-45"><a href="#cb86-45" tabindex="-1"></a>    Bn.y <span class="ot">&lt;-</span> n<span class="sc">/</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">colMeans</span>(use.y.matrix) <span class="sc">-</span> <span class="fu">mean</span>(use.y.matrix))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-46"><a href="#cb86-46" tabindex="-1"></a>    Bn <span class="ot">&lt;-</span> (Bn.x<span class="sc">+</span>Bn.y)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb86-47"><a href="#cb86-47" tabindex="-1"></a>    part.x.matrix <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(use.x.matrix) <span class="sc">-</span> <span class="fu">colMeans</span>(use.x.matrix))</span>
<span id="cb86-48"><a href="#cb86-48" tabindex="-1"></a>    part.y.matrix <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(use.y.matrix) <span class="sc">-</span> <span class="fu">colMeans</span>(use.y.matrix))</span>
<span id="cb86-49"><a href="#cb86-49" tabindex="-1"></a>    Wn.x <span class="ot">&lt;-</span> <span class="fu">sum</span>(part.x.matrix<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>k<span class="sc">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb86-50"><a href="#cb86-50" tabindex="-1"></a>    Wn.y <span class="ot">&lt;-</span> <span class="fu">sum</span>(part.y.matrix<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>k<span class="sc">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb86-51"><a href="#cb86-51" tabindex="-1"></a>    Wn <span class="ot">&lt;-</span> (Wn.x<span class="sc">+</span>Wn.y)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb86-52"><a href="#cb86-52" tabindex="-1"></a>    Rn[n<span class="sc">-</span>start<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1-1</span><span class="sc">/</span>n<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n<span class="sc">*</span>(Bn<span class="sc">/</span>Wn)</span>
<span id="cb86-53"><a href="#cb86-53" tabindex="-1"></a>}</span>
<span id="cb86-54"><a href="#cb86-54" tabindex="-1"></a><span class="fu">plot</span>(Rn[<span class="dv">100</span><span class="sc">:</span><span class="dv">500</span>],<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Rn&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6ZmY6kNtmAABmADpmZmZmtrZmtv+QOgCQkGaQ2/+2ZgC2/7a2///bkDrbkJDb/9vb////tmb/25D//7b//9v///9oedAkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGBklEQVR4nO3d4ZqbRACFYWy3azVRE41Fl91w/3fZDETcbRI+BgbmkJzvl7azA88rARInbFG73orcO6CegSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIEgA0EGggwEGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIEgA0EGggwEGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIEgA0EGggwEGQgyEGQgyEBQDNDb9ullth1RLQ7o1+fNbHsiWhzQpi6LL7Pti2SxQHVdFQ9lFA9UN0afvl2fbjXNCpRmuqwZCJoFaPnp5isv0AqY5gYqb52kp0y6ZAsfQT9eHPSFMp+DDATTGQimMxBM96BAb9v/T8a9V7FHBaqP+xsuF9PJC830Ejvu4Y38owOd3sfvBk33sEBDpzMQTGcgmM5ANJ26kIEgA0HZgdSFMn8elGzi2fIRBBkIMhCUH0hcyECQgSABIG0hA0EGggwEGQhSAJIWMhBkIEgCSFko/+dB6SafJR9BkIEgA0EaQMJCBoJmBXp9vrnE47GBhq8wGzP7ss1zBFVF82WNBz2CjvveY6Op/VLmgwIdaP1hO+qnvyKAdIXigQZ816mpLDaPCtS/+rDr9fnzQwLhAtau08lqMJCs0IhzEC1gHbfd+wHqbnIGnav7vy82ZkcWTuPzoGTzp28C0D9DjqDh04kKRQOV59cWfx0jcrt3AlSd7v8Op7vkqigmPZ3jynY1hSKBmmv86U6oLE5Qibd7F0DNbfRx/0v/Uzni381H7cqiRQOFe6ADvbyGf19szK4s2jggfH7S4O+LjdqXJRsHxG82hn5fbNS+LNlcQKO2qyhkICgaCK9PE7Z7B0Azb1dQSAtIUMhAkBiQnpDM50FJN5MwtSNITkgPSExIDkjtEBIE0hLSAxI7hASBtIQkgZSEFIGkDiFJICUhTSAhIVEgHSFZIBUhVSCZQ0gWSEVIF0hESBhI4zyk9oHZDNuclvIRJCGkDSQgJA6UX0gdKLuQPlBmIXmg3EL6QJmFZgEat0bx9qZzCs1zBI1ao9gzOKPQTC+xUWsU+4ZnM5rrHDRmjWL/D8T8triEreAk/e6HMiCtCqj5wYWNVgdUL3wgzQ00+At1kS1mJP15EM81fRbcSvKBS0431ago8L/YuoHqaKPiY/wXqweqBxgNOFBuznkPQM18vU2ZOPnAOvmb1ayt4s1qzlbyZjVfq3mzmqtsJ+nVlAkoatIsw6I/soobnnRSAykOM1CqceOGJ53UQIrDDJRq3LjhSSc1kOIwCaB7ykCQgSADQQaCDAQZCDIQZCDIQJCBIANBBoLSA1VF/xNzX79++zCMxvdVXkwyZbarJQcKD16uevbxbdv87+tuGI3vK6xz+zjJlNmulxrouA8PzL39yMqqXffQDaPxfZ2fYfwlzWw3Sg3U/lKSW0sYw28HqsLfdcNgPBeA0s12WXKgn8PxXfXsYgv03zAeD5Xhd+kkm+2y1EDtCaDvNNDsfjeMx/dvrnnEfKrZrrVyoPASe3pZE9DiL7HAsaaXGJ8mE5+kw1RrOknzhbZKdplvOU7zrekyz7dqVbobxfAQ/sZkRTeK727/b3Q+Q3TDaHxfh6Jo1wQmme1qfrMKGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoIMBBkIMhBkIMhAkIEgA0EGggwEGQgyEKQHdLH2IO1ihNgMBBkIkgR62/6xbde1hNUsfwag0z+E5Zph8VizPHqxRIFOJmF97yEspS/O//L6vGmWS5VPLwvujijQ5t3aw8P5D5qlV9Wnv39b9BUnCrQLXzTYdav12tNQ43UoUq5A5KSByg7o/GS2HT+HL3XSQD8cQaHj/veUi3w5aaDzsufzHzSVT//ul7yIaQM1F6/uKtaerXdpF9Jj2kAf74NOMO3K6CVP03pAYhkIMhBkIMhAkIEgA0EGggwEGQgyEGQgyECQgSADQQaCDAQZCDIQZCDIQJCBIANBBoK+A9HyjwxC1uJVAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="excercise-4" class="section level2">
<h2>Excercise 4</h2>
<p>Stationarity: <span class="math inline">\(K(s,r)f(s) =
K(r,s)f(r)\)</span>.</p>
<p>解：当 <span class="math inline">\(s=r\)</span>
时，该式显然成立；</p>
<p>当 <span class="math inline">\(s\ne r\)</span> 时，<span class="math inline">\(K(r,s)=\alpha(r,s)g(s|r),\alpha(s,r)=\min\{\frac{f((r)g(s|r)}{f(s)g(r|s)},1\}\)</span>，此时等式右侧为：
<span class="math display">\[
K(r,s)f(r)=\alpha(r,s)g(s|r)f(r)=\begin{cases}
f(s)g(r|s) &amp; f(s)g(r|s)\le f(r)g(s|r)\\
f(r)g(s|r) &amp; f(s)g(r|s)&gt; f(r)g(s|r)
\end{cases}
\]</span> 同理等式左侧为： <span class="math display">\[
K(s,r)f(s)=\begin{cases}
f(r)g(s|r) &amp; f(r)g(s|r)&lt;f(s)g(r|s)\\
f(s)g(r|s) &amp; f(r)g(s|r)\ge f(s)g(r|s)
\end{cases}
\]</span> 容易看出，此时等式两侧相等；</p>
<p>综上所述，有 <span class="math inline">\(K(s,r)f(s) =
K(r,s)f(r)\)</span>。</p>
</div>
</div>
<div id="homework---7" class="section level1">
<h1>Homework - 7</h1>
<div id="excercise-1---11.3" class="section level2">
<h2>Excercise 1 - 11.3</h2>
<p>(a)Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[
\sum_{k=0}^\infty\frac{(-1)^k}{k!2^k}\frac{\|a\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}2)\Gamma(k+\frac32)}{\Gamma(k+\frac
d2+1)},
\]</span> where d ≥ 1 is an integer, a is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large k and d. (This sum converges for all <span class="math inline">\(a \in R^d\)</span>).</p>
<p>(b)Modify the function so that it computes and returns the sum.</p>
<p>(c)Evaluate the sum when <span class="math inline">\(a = (1,
2)^T\)</span> .</p>
<p>解：(a) 讲第 <span class="math inline">\(k\)</span>
项正部分取对数后取指数得到 <span class="math display">\[
(-1)^k\exp\left\{(2k+2)\ln\|a\|+\ln\Gamma(\frac{d+1}2)+\ln\Gamma(k+\frac32)-\ln
k!-k\ln2-\ln(2k+1)-\ln(2k+2)-\ln\Gamma(k+\frac d2+1)\right\}
\]</span></p>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>calculate.k <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a){</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>    log.part <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lfactorial</span>(k)<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>    <span class="fu">return</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(log.part))</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>}</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a><span class="fu">calculate.k</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## [1]   16.66667  -41.66667  148.80952 -516.69974</code></pre>
<p>(b)其实现代码如下：</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>sum.to.k <span class="ot">&lt;-</span> <span class="cf">function</span>(end.k,a){</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>    part <span class="ot">&lt;-</span> <span class="fu">calculate.k</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>end.k),a)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sum=</span><span class="fu">sum</span>(part),<span class="at">part=</span><span class="fu">cumsum</span>(part)))</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>}</span></code></pre></div>
<p>(c)其实现代码如下：</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">sum.to.k</span>(<span class="dv">50</span>,a)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>out<span class="sc">$</span>sum</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">plot</span>(out<span class="sc">$</span>part,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;sum&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="excercise-2---11.5" class="section level2">
<h2>Excercise 2 - 11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[
\frac{2Γ( \frac k2 )}{\sqrt{π(k − 1)}Γ( \frac{k−1}2 )}
\int^{c_{k−1}}_0\left(1 + \frac {u^2}{k − 1}\right)^{−k/2}du
=\frac{2Γ( \frac {k+1}2 )}{\sqrt{πk}Γ( \frac{k}2 )}
\int^{c_{k}}_0\left(1 + \frac {u^2}{k}\right)^{−(k+1)/2}du
\]</span> for a, where <span class="math inline">\(c_k=\sqrt{\frac{a^2k}{k + 1 − a^2}}\)</span> .</p>
<p>Compare the solutions with the points A(k) in Exercise 11.4.</p>
<p>解：讲上述方程移项后，使用优化函数寻找左式的根(右式为0)，其实现代码如下：</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>my.function <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>    <span class="cf">if</span>(a<span class="sc">==</span><span class="dv">0</span>){<span class="fu">return</span>(<span class="dv">1000</span>)}</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>    c.k <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>    f.u <span class="ot">&lt;-</span> <span class="cf">function</span>(u,k){(<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k))<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>    left <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f.u,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span><span class="fu">c.k</span>(a,k<span class="dv">-1</span>),<span class="at">k=</span>k<span class="dv">-1</span>)<span class="sc">$</span>value<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>    right <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f.u,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span><span class="fu">c.k</span>(a,k),<span class="at">k=</span>k)<span class="sc">$</span>value<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(k))<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>    <span class="fu">return</span>(left<span class="sc">-</span>right)</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>}</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>k.li <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>root.li <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k.li))</span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k.li)){</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a>    root.li[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(my.function,<span class="fu">c</span>(<span class="fl">1e-4</span>,<span class="dv">2</span>),<span class="at">k=</span>k.li[i])<span class="sc">$</span>root</span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a>}</span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a><span class="co"># Exercise 4</span></span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a>func<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a>    c.k <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="fu">c.k</span>(a,k<span class="dv">-1</span>),<span class="at">df=</span>k<span class="dv">-1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">c.k</span>(a,k),<span class="at">df=</span>k)</span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a>}</span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a></span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a>root.li<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k.li))</span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k.li)){</span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a>    root.li<span class="fl">.4</span>[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(func<span class="fl">.4</span>,<span class="fu">c</span>(<span class="fl">1e-4</span>,<span class="dv">2</span>),<span class="at">k=</span>k.li[i])<span class="sc">$</span>root</span>
<span id="cb93-24"><a href="#cb93-24" tabindex="-1"></a>}</span>
<span id="cb93-25"><a href="#cb93-25" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">k=</span>k.li,<span class="st">&#39;a.k&#39;</span><span class="ot">=</span>root.li,<span class="st">&#39;a-k-4&#39;</span><span class="ot">=</span>root.li<span class="fl">.4</span>,<span class="at">error=</span>root.li<span class="sc">-</span>root.li<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>##       k      a.k    a.k.4         error
## 1     4 1.492103 1.492103 -2.220446e-16
## 2     5 1.533556 1.533556 -1.154632e-14
## 3     6 1.562744 1.562744 -8.437695e-15
## 4     7 1.584430 1.584430 -2.975398e-14
## 5     8 1.601185 1.601185  2.242651e-14
## 6     9 1.614521 1.614521 -1.398881e-14
## 7    10 1.625390 1.625390  1.252332e-13
## 8    11 1.634419 1.634419 -1.441069e-13
## 9    12 1.642038 1.642038  1.834088e-13
## 10   13 1.648554 1.648554 -1.976197e-13
## 11   14 1.654190 1.654190 -3.330669e-15
## 12   15 1.659114 1.659114  7.245315e-13
## 13   16 1.663452 1.663452 -1.101785e-12
## 14   17 1.667304 1.667304  1.998623e-12
## 15   18 1.670745 1.670745 -1.387335e-12
## 16   19 1.673840 1.673840 -6.985523e-13
## 17   20 1.676637 1.676637  1.140865e-12
## 18   21 1.679178 1.679178  4.461098e-12
## 19   22 1.681496 1.681496 -9.858558e-12
## 20   23 1.683620 1.683620  9.402701e-12
## 21   24 1.685572 1.685572 -6.517009e-12
## 22   25 1.687373 1.687373 -5.239587e-12
## 23  100 1.720608 1.720608  2.329004e-09
## 24  500 1.729755 1.729755  1.851696e-08
## 25 1000 1.730907 1.730907 -3.364839e-07</code></pre>
<p>容易看出，两者解法差距不大；但当 <span class="math inline">\(k\)</span> 变大时，两者解的差值逐渐变大。</p>
</div>
<div id="exercise-3-2" class="section level2">
<h2>Exercise 3</h2>
<p>Suppose <span class="math inline">\(T_1, \cdots , T_n\)</span> are
<span class="math inline">\(i.i.d.\)</span> samples drawn from the
exponential distribution with expectation <span class="math inline">\(λ\)</span>. Those values greater than <span class="math inline">\(τ\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i ≤ τ ) + τ I(T_i &gt; τ ),i = 1,
\cdots, n\)</span>. Suppose <span class="math inline">\(τ = 1\)</span>
and the observed <span class="math inline">\(Y_i\)</span> values are as
follows:</p>
<p>0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85</p>
<p>Use the E-M algorithm to estimate <span class="math inline">\(λ\)</span>, compare your result with the observed
data MLE (note: <span class="math inline">\(Y_i\)</span> follows a
mixture distribution)</p>
<p>解：对于该问题，EM算法的具体步骤为：</p>
<ul>
<li>给定 <span class="math inline">\(\lambda_0\)</span>;</li>
<li>对于 <span class="math inline">\(i=1,2,\cdots\)</span> 重复:
<ul>
<li><span class="math inline">\(\lambda_i=\underset{\lambda}{\arg\max}\left\{-N\ln\lambda-\frac1\lambda\sum_{i=1}^{n_1}T_i^{(o)}-\frac{n_2E(T_j^{(m)}|\lambda_{i-1})}\lambda\right\}\)</span>
直至收敛。</li>
</ul></li>
</ul>
<p>在本题中, <span class="math inline">\(E(T_j^{(m)}|\lambda_{i-1})=\frac{\lambda_{i-1}+1}{\lambda_{i-1}^2},N=10,n_1=7,n_2=3,T_i^{(o)}\)</span>
表示观察到的数据，<span class="math inline">\(T_j^{(m)}\)</span>
表示未观察到的数据。</p>
<p>其实现代码如下：</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>T0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">0.91</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>iter.num <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(xdata),<span class="fu">numeric</span>(iter.num))</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter.num){</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>    part <span class="ot">&lt;-</span> lambda[i]</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>    lambda[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(T0)<span class="sc">+</span>n2<span class="sc">*</span>(part<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>part<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>N</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>}</span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>lambda[iter.num<span class="sc">+</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.9869514</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">plot</span>(lambda,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>易知 <span class="math inline">\(Y\sim f=\frac1\lambda
e^{-y/\lambda}I(0&lt;y&lt;1)+e^{-1/\lambda}I(y=1)\)</span>，则 <span class="math inline">\(\hat\lambda_{MLE}=\underset{\lambda}{\arg\max}\ln
L(\lambda;Y)\)</span>，其实现代码如下所示：</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>lambda.MLE <span class="ot">&lt;-</span> (<span class="fu">sum</span>(T0)<span class="sc">+</span><span class="dv">3</span>)<span class="sc">/</span><span class="dv">7</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>lambda.MLE</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
</div>
</div>
<div id="homework---8" class="section level1">
<h1>Homework - 8</h1>
<div id="exercise-1---11.7" class="section level2">
<h2>Exercise 1 - 11.7</h2>
<p>Use the simplex algorithm to solve the following problem.Minimize
<span class="math inline">\(4x + 2y + 9z\)</span> subject to <span class="math display">\[
\begin{array}{l}
2x + y + z ≤ 2\\
x − y + 3z ≤ 3\\
x ≥ 0, y ≥ 0, z ≥ 0.
\end{array}
\]</span></p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>f.obj <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">9</span>)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>f.con <span class="ot">&lt;-</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>f.dir <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&gt;=&quot;</span>, <span class="st">&quot;&gt;=&quot;</span>, <span class="st">&quot;&gt;=&quot;</span>)</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>f.rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, f.obj, f.con, f.dir, f.rhs)</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>solution<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>solution</span></code></pre></div>
<pre><code>## Success: the objective function is 0</code></pre>
</div>
<div id="exercise-2.1---3." class="section level2">
<h2>Exercise 2.1 - 3.</h2>
<p>Use both for loops and <code>lapply()</code> to fit linear models to
the <code>mtcars</code> using the formulas stored in this list:</p>
<pre><code>formulas &lt;- list(
    mpg ~ disp,
    mpg ~ I(1 / disp),
    mpg ~ disp + wt,
    mpg ~ I(1 / disp) + wt
)</code></pre>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)  <span class="co"># %&gt;% </span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>    mpg <span class="sc">~</span> disp,</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>    mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>    mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>    mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>)</span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a>li.md<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a>    formulas[[i]] <span class="sc">%&gt;%</span> <span class="fu">lm</span>(mtcars) <span class="ot">-&gt;</span> li.md<span class="fl">.1</span>[[i]]</span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a>}</span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a>li.md<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data=</span>mtcars)</span>
<span id="cb109-12"><a href="#cb109-12" tabindex="-1"></a>li.md<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = ., data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = ., data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>li.md<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67</code></pre>
</div>
<div id="exercise-2.2---4." class="section level2">
<h2>Exercise 2.2 - 4.</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply().Can you do it
without an anonymous function?</p>
<pre><code>bootstraps &lt;- lapply(1:10, function(i) {
    rows &lt;- sample(1:nrow(mtcars), rep = TRUE)
    mtcars[rows, ]
})</code></pre>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>    mtcars[rows, ]</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>})</span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>li.md<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a>    bootstraps[[i]] <span class="sc">%&gt;%</span> <span class="fu">lm</span>(<span class="at">formula=</span>mpg <span class="sc">~</span> disp) <span class="ot">-&gt;</span> li.md<span class="fl">.3</span>[[i]]</span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a>}</span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a>bootstraps <span class="sc">%&gt;%</span> <span class="fu">lapply</span>(lm,<span class="at">formula=</span>mpg <span class="sc">~</span> disp) <span class="ot">-&gt;</span> li.md<span class="fl">.4</span></span>
<span id="cb114-10"><a href="#cb114-10" tabindex="-1"></a>li.md<span class="fl">.3</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    29.93504     -0.04389  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    26.55342     -0.03023</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>li.md<span class="fl">.4</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.93504     -0.04389  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.55342     -0.03023</code></pre>
</div>
<div id="exercise-2.3---5." class="section level2">
<h2>Exercise 2.3 - 5.</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<pre><code>rsq &lt;- function(mod) summary(mod)$r.squared</code></pre>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&#39;li.md.&#39;</span>,i) <span class="sc">%&gt;%</span> <span class="fu">parse</span>(<span class="at">text =</span> .) <span class="sc">%&gt;%</span> <span class="fu">eval</span>() <span class="sc">%&gt;%</span> <span class="fu">lapply</span>(rsq) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038
## [1] 0.7183433 0.8596865 0.7809306 0.8838038
## [1] 0.7274432 0.5347959 0.7526255 0.6923304
## [1] 0.7274432 0.5347959 0.7526255 0.6923304</code></pre>
</div>
<div id="exercise-3.1---3." class="section level2">
<h2>Exercise 3.1 - 3.</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<pre><code>trials &lt;- replicate(
100,
t.test(rpois(10, 10), rpois(7, 10)),
simplify = FALSE
)</code></pre>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>    <span class="dv">100</span>,</span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>    <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>    <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>)</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a><span class="fu">sapply</span>(trials,<span class="cf">function</span>(i){i<span class="sc">$</span>p.value}) <span class="ot">-&gt;</span> p.value<span class="fl">.1</span></span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>p.value<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.7883102 0.7816840 0.2749405 0.8304775 0.6053179</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="fu">sapply</span>(trials,<span class="st">&#39;[[&#39;</span>,<span class="st">&#39;p.value&#39;</span>) <span class="ot">-&gt;</span> p.value<span class="fl">.2</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>p.value<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.7883102 0.7816840 0.2749405 0.8304775 0.6053179</code></pre>
</div>
<div id="exercise-3.2---6." class="section level2">
<h2>Exercise 3.2 - 6.</h2>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>my.lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(X, FUN, FUN.VALUE){</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>    out1 <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN,X)</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>    <span class="fu">vapply</span>(out1,identity,<span class="at">FUN.VALUE=</span>FUN.VALUE)</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>}</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a><span class="fu">my.lapply</span>(x,<span class="cf">function</span>(i)i<span class="sc">^</span><span class="dv">2</span>,<span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1]  1  4  9 16</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">sapply</span>(x,<span class="cf">function</span>(i)i<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1]  1  4  9 16</code></pre>
</div>
<div id="exercise-4.1---4." class="section level2">
<h2>Exercise 4.1 - 4.</h2>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>).</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>my.chisq.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>  all.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>  margin1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(all.data)</span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a>  margin2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(all.data)</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a>  all.sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(all.data)</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>  part <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(margin1, margin2) <span class="sc">/</span> all.sum</span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a>  x.stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((all.data <span class="sc">-</span> part)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> part)</span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">length</span>(margin1) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">length</span>(margin2) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(x.stat, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a></span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">x.stat =</span> x.stat, <span class="at">df =</span> df, <span class="at">p.value =</span> p.value)</span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a>}</span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb130-15"><a href="#cb130-15" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">22</span>,<span class="dv">2</span>)</span>
<span id="cb130-16"><a href="#cb130-16" tabindex="-1"></a><span class="fu">my.chisq.test</span>(x,y)</span></code></pre></div>
<pre><code>## $x.stat
## [1] 12.51243
## 
## $df
## [1] 5
## 
## $p.value
## [1] 0.02840249</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">cbind</span>(x,y))</span></code></pre></div>
<pre><code>## Warning in chisq.test(cbind(x, y)): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  cbind(x, y)
## X-squared = 12.512, df = 5, p-value = 0.0284</code></pre>
</div>
<div id="exercise-4.2---5." class="section level2">
<h2>Exercise 4.2 - 5.</h2>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>my.table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>  </span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>  x.x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>  y.y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a>  </span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a>  x.l <span class="ot">&lt;-</span> <span class="fu">length</span>(x.x)</span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>  y.l <span class="ot">&lt;-</span> <span class="fu">length</span>(y.y)</span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>  </span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a>  dims <span class="ot">&lt;-</span> <span class="fu">c</span>(x.l, y.l)</span>
<span id="cb135-10"><a href="#cb135-10" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> x.l <span class="sc">*</span> y.l</span>
<span id="cb135-11"><a href="#cb135-11" tabindex="-1"></a>  dn <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> x.x, <span class="at">y =</span> y.y)</span>
<span id="cb135-12"><a href="#cb135-12" tabindex="-1"></a>  </span>
<span id="cb135-13"><a href="#cb135-13" tabindex="-1"></a>  bin <span class="ot">&lt;-</span> <span class="fu">match</span>(x, x.x) <span class="sc">+</span></span>
<span id="cb135-14"><a href="#cb135-14" tabindex="-1"></a>    x.l <span class="sc">*</span> <span class="fu">match</span>(y, y.y) <span class="sc">-</span> x.l</span>
<span id="cb135-15"><a href="#cb135-15" tabindex="-1"></a>  part <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(bin, pr)</span>
<span id="cb135-16"><a href="#cb135-16" tabindex="-1"></a>  </span>
<span id="cb135-17"><a href="#cb135-17" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">array</span>(part, <span class="at">dim =</span> dims, <span class="at">dimnames =</span> dn)</span>
<span id="cb135-18"><a href="#cb135-18" tabindex="-1"></a>  <span class="fu">class</span>(out) <span class="ot">&lt;-</span> <span class="st">&quot;table&quot;</span></span>
<span id="cb135-19"><a href="#cb135-19" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb135-20"><a href="#cb135-20" tabindex="-1"></a>}</span>
<span id="cb135-21"><a href="#cb135-21" tabindex="-1"></a></span>
<span id="cb135-22"><a href="#cb135-22" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">5</span>, <span class="dv">100</span>, <span class="cn">TRUE</span>)</span>
<span id="cb135-23"><a href="#cb135-23" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">5</span>, <span class="dv">100</span>, <span class="cn">TRUE</span>)</span>
<span id="cb135-24"><a href="#cb135-24" tabindex="-1"></a><span class="fu">my.table</span>(a, b)</span></code></pre></div>
<pre><code>##    y
## x   1 2 3 4 5
##   1 4 4 4 6 5
##   2 4 5 2 2 2
##   3 6 5 4 4 2
##   4 7 3 3 1 6
##   5 6 4 4 6 1</code></pre>
<p>卡方检验中未使用该函数。</p>
</div>
</div>
<div id="homework---9" class="section level1">
<h1>Homework - 9</h1>
<div id="exercise---1" class="section level2">
<h2>Exercise - 1</h2>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical
Computing with R).</p>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x, y) ∝C_n^x y^{x+a−1}(1 − y)^{n−x+b−1}, x = 0, 1,\cdots, n, 0 ≤ y ≤
1.
\]</span> It can be shown (see e.g. [23]) that for fixed a, b, n, the
conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b).
Use the Gibbs sampler to generate a chain with target joint density f(x,
y).</p>
<p>解：<span class="math inline">\((X,Y)\sim f(x,y)\)</span>，且 <span class="math inline">\(X|Y=y \sim B(n,y),Y|X=x\sim
Beta(x+a,n-x+b)\)</span>，则Gibbs采样步骤为：</p>
<ul>
<li>初始值 <span class="math inline">\(X_1=1,Y_1\)</span> 从 <span class="math inline">\(beta(1+a,n-1+b)\)</span> 中生成；</li>
<li>对于 <span class="math inline">\(i=2,\cdots,N\)</span>，从 <span class="math inline">\(X|Y=Y_{i-1}\)</span> 生成 <span class="math inline">\(X_i\)</span>，从 <span class="math inline">\(Y|X=X_i\)</span> 中生成 <span class="math inline">\(Y_i\)</span>；</li>
</ul>
<p>其实现代码如下所示：</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>cf <span class="ot">=</span> <span class="st">&quot;NumericMatrix gibbsC(int N, int thin, int n, int a, int b) {</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a><span class="st">  double x = 0, y = 0;</span></span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a><span class="st">  for(int i = 0; i &lt; N; i++) {</span></span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a><span class="st">    for(int j = 0; j &lt; thin; j++) {</span></span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a><span class="st">      x = rbinom(1,n,y)[0];</span></span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a><span class="st">      y = rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a><span class="st">    mat(i, 0) = x;</span></span>
<span id="cb139-10"><a href="#cb139-10" tabindex="-1"></a><span class="st">    mat(i, 1) = y;</span></span>
<span id="cb139-11"><a href="#cb139-11" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb139-12"><a href="#cb139-12" tabindex="-1"></a><span class="st">  return(mat);</span></span>
<span id="cb139-13"><a href="#cb139-13" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb139-14"><a href="#cb139-14" tabindex="-1"></a><span class="fu">cppFunction</span>(cf)</span>
<span id="cb139-15"><a href="#cb139-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb139-16"><a href="#cb139-16" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb139-17"><a href="#cb139-17" tabindex="-1"></a>thin <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb139-18"><a href="#cb139-18" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb139-19"><a href="#cb139-19" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb139-20"><a href="#cb139-20" tabindex="-1"></a>sample.data <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(N,thin,n,a,b)</span>
<span id="cb139-21"><a href="#cb139-21" tabindex="-1"></a><span class="fu">head</span>(sample.data)</span></code></pre></div>
<pre><code>##      [,1]      [,2]
## [1,]    2 0.3819775
## [2,]    3 0.5391279
## [3,]    6 0.3110401
## [4,]    2 0.2605495
## [5,]    1 0.2611712
## [6,]    1 0.2308473</code></pre>
</div>
<div id="exercise---2" class="section level2">
<h2>Exercise - 2</h2>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>func.R <span class="ot">&lt;-</span> <span class="cf">function</span>(N,thin,n,a,b){</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>    sample.data.R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a>    x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>        <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> thin) {</span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a>          x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)[<span class="dv">1</span>];</span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a>          y <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)[<span class="dv">1</span>];</span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a>        }</span>
<span id="cb141-9"><a href="#cb141-9" tabindex="-1"></a>        sample.data.R[i, <span class="dv">1</span>] <span class="ot">=</span> x;</span>
<span id="cb141-10"><a href="#cb141-10" tabindex="-1"></a>        sample.data.R[i, <span class="dv">2</span>] <span class="ot">=</span> y;</span>
<span id="cb141-11"><a href="#cb141-11" tabindex="-1"></a>    }</span>
<span id="cb141-12"><a href="#cb141-12" tabindex="-1"></a>    <span class="fu">return</span>(sample.data.R)</span>
<span id="cb141-13"><a href="#cb141-13" tabindex="-1"></a>}</span>
<span id="cb141-14"><a href="#cb141-14" tabindex="-1"></a>sample.data.R <span class="ot">&lt;-</span> <span class="fu">func.R</span>(N,thin,n,a,b)</span>
<span id="cb141-15"><a href="#cb141-15" tabindex="-1"></a><span class="fu">qqplot</span>(sample.data[,<span class="dv">1</span>],sample.data.R[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="fu">qqplot</span>(sample.data[,<span class="dv">2</span>],sample.data.R[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise---3" class="section level2">
<h2>Exercise - 3</h2>
<p>Campare the computation time of the two functions with the function
“microbenchmark”.</p>
<p>解：其实现代码如下：</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">meanR=</span><span class="fu">func.R</span>(N,thin,n,a,b),<span class="at">meanC=</span><span class="fu">gibbsC</span>(N,thin,n,a,b))</span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr       lq    median        uq
## 1 meanR 625.7685 628.09610 631.63340
## 2 meanC  63.8453  65.22125  66.24455</code></pre>
</div>
<div id="exercise---4" class="section level2">
<h2>Exercise - 4</h2>
<p>Comments your results.</p>
<p>容易看出，<code>R</code> 函数和 <code>C++</code>
函数都能够产生服从指定分布的样本；在用时方面，<code>C++</code>
函数耗时显著减小，大概是 <code>R</code> 函数的十分之一。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
